<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN" "http://www.ibatis.com/dtd/sql-map-2.dtd">

<sqlMap namespace="ga.sealManger">

<insert id="addSealApply" parameterClass="SimpleMap">
  <![CDATA[	
 insert  into GA_SEAL_APPLY(
  DOCUMENTNO,
  APPLYORID,
  APPLYORDEPTID,
  APPLYDATE,
  USEDATE ,
  USESEALTYPE,
  SELECTDEPTID,
  USEINFORMATION,
  USESHARES,
  NOTE,
  DRAFT_NO,
  FILENAME,
  FILEPATH,
  ISLEND,
  RETURNDATE
  ) values (
  #documentno:VARCHAR#,
  #applerId:VARCHAR#,
  #deptId:VARCHAR#,
  SYSDATE,
  to_date(#useDate:VARCHAR#,'yyyy-mm-dd'),
  #sealType:VARCHAR#,
  #selectDeptid:VARCHAR#,
  #useInformation:VARCHAR#,
  #useShares:NUMERIC#,
  #note:VARCHAR#,
  #draftNo:VARCHAR#,
  #fileName:VARCHAR#,
  #filePath:VARCHAR#,
  #isLend:VARCHAR#,
  to_date(#returnDate:VARCHAR#,'yyyy-mm-dd')
  )
  ]]>

</insert>
<insert id="addVisaApply" parameterClass="SimpleMap">
  <![CDATA[	
 insert  into GA_Visa_APPLY(
  DOCUMENTNO,
  APPLYORID,
  APPLYORDEPTID,
  APPLYDATE,
  USEFDATE ,
  USETDATE ,
  USEVISATYPE,
  SELECTDEPTID,
  USEINFORMATION,
  USESHARES,
  NOTE,
  DRAFT_NO,
  FILENAME,
  FILEPATH,
  ISLEND,
  RETURNDATE
  ) values (
  #documentno:VARCHAR#,
  #applerId:VARCHAR#,
  #deptId:VARCHAR#,
  SYSDATE,
  to_date(#usefDate:VARCHAR#,'yyyy-mm-dd'),
   to_date(#usetDate:VARCHAR#,'yyyy-mm-dd'),
  #sealType:VARCHAR#,
  #selectDeptid:VARCHAR#,
  #useInformation:VARCHAR#,
  #useShares:NUMERIC#,
  #note:VARCHAR#,
  #draftNo:VARCHAR#,
  #fileName:VARCHAR#,
  #filePath:VARCHAR#,
  #isLend:VARCHAR#,
  to_date(#returnDate:VARCHAR#,'yyyy-mm-dd')
  )
  ]]>

</insert>

<insert id="addSealAffirm" parameterClass="SimpleMap">
  <![CDATA[	
    insert into GA_SEAL_AFFIRM(    
	  GA_AFFIRM_NO,
	  APPLY_NO,
	  AFFIRM_FLAG,
	  AFFIRM_LEVEL,
	  AFFIRMOR_ID,
	  CREATE_DATE,
	  CREATED_BY,	
	  ACTIVITY,
	  APPLY_TYPE
   )values(
   GA_SEAL_AFFIRM_SEQ.NEXTVAL,
   #documentno:VARCHAR#,
   #affirmFlag:NUMERIC#,
   #AffirmorLevel:NUMERIC#,
   #AffirmorId:VARCHAR#,
   SYSDATE,
   #applerId:VARCHAR#,
   '1', 
   'SealApply'
   )   
   
  ]]>
</insert>
<insert id="addVisaAffirm" parameterClass="SimpleMap">
  <![CDATA[	
    insert into GA_VISA_AFFIRM(    
	  GA_AFFIRM_NO,
	  APPLY_NO,
	  AFFIRM_FLAG,
	  AFFIRM_LEVEL,
	  AFFIRMOR_ID,
	  CREATE_DATE,
	  CREATED_BY,	
	  ACTIVITY,
	  APPLY_TYPE
   )values(
   GA_VISA_AFFIRM_SEQ.NEXTVAL,
   #documentno:VARCHAR#,
   #affirmFlag:NUMERIC#,
   #AffirmorLevel:NUMERIC#,
   #AffirmorId:VARCHAR#,
   SYSDATE,
   #applerId:VARCHAR#,
   '1', 
   'SealApply'
   )   
   
  ]]>
</insert>
<select id="sealAffirmAndInformationListNumber" parameterClass="SimpleMap" resultClass="int">
  <![CDATA[	
    select count(t.documentno) as documentno  
from ga_seal_apply t , hr_employee e,
(SELECT GA_SEAL_AFFIRM.*,
               UP_AFFIRM.AFFIRMOR_ID UP_AFFIRMOR_ID,
               NVL(UP_AFFIRM.AFFIRM_FLAG, 1) UP_AFFIRM_FLAG,
               CASE
                 WHEN GA_SEAL_AFFIRM.AFFIRM_LEVEL =
                      MAX_AFFIRM.MAX_LEVEL THEN
                  1
                 ELSE
                  0
               END AS MAX_LEVEL_FLAG
          FROM (SELECT GA_SEAL_AFFIRM.*,
                       GA_SEAL_AFFIRM.AFFIRM_LEVEL - 1 UP_LEVEL,
                       GA_SEAL_AFFIRM.AFFIRM_LEVEL + 1 NEXT_LEVEL
                  FROM GA_SEAL_AFFIRM) GA_SEAL_AFFIRM,
               (SELECT GA_SEAL_AFFIRM.APPLY_NO,
                       GA_SEAL_AFFIRM.AFFIRM_LEVEL,
                       GA_SEAL_AFFIRM.AFFIRMOR_ID,
                       GA_SEAL_AFFIRM.AFFIRM_FLAG
                  FROM GA_SEAL_AFFIRM) UP_AFFIRM,
               (SELECT GA_SEAL_AFFIRM.APPLY_NO,
                       MAX(GA_SEAL_AFFIRM.AFFIRM_LEVEL) MAX_LEVEL
                  FROM GA_SEAL_AFFIRM
                 GROUP BY GA_SEAL_AFFIRM.APPLY_NO) MAX_AFFIRM
         WHERE GA_SEAL_AFFIRM.APPLY_NO = UP_AFFIRM.APPLY_NO(+)
           AND GA_SEAL_AFFIRM.UP_LEVEL = UP_AFFIRM.AFFIRM_LEVEL(+)
           AND GA_SEAL_AFFIRM.APPLY_NO = MAX_AFFIRM.APPLY_NO(+)
           and GA_SEAL_AFFIRM.affirmor_id = #applerId:VARCHAR#) AFFIRM
where   AFFIRM.UP_AFFIRM_FLAG=1
   and t.DOCUMENTNO=AFFIRM.APPLY_NO and e.person_id=t.applyorid
   and t.DOCUMENTNO in
       (select distinct a.apply_no
          from GA_SEAL_AFFIRM a
         where a.affirmor_id = #applerId:VARCHAR#
           ]]>
   <isEqual prepend="AND" property="qryType" compareValue="0"> <!-- 未决裁过的 -->
		<![CDATA[
				 a.affirm_flag=0
	]]>
	</isEqual>
	<isEqual prepend="AND" property="qryType" compareValue="1"> <!-- 决裁通过的 -->
		<![CDATA[
				 a.affirm_flag =1
	]]>
	</isEqual>
	<isEqual prepend="AND" property="qryType" compareValue="2"> <!-- 决裁否决的 -->
		<![CDATA[
				 a.affirm_flag =2
	]]>
	</isEqual>
  <![CDATA[	
   )
   ]]>
   <isEmpty prepend="AND" property="qryType">
		<![CDATA[		   
		 a.affirm_flag=0
		]]>	
	</isEmpty>
	<isNotEmpty prepend="AND" property="key">
		<![CDATA[		   
		 (e.chinesename LIKE  '%'||#key:VARCHAR# || '%'  or t.APPLYORID LIKE  '%'||#key:VARCHAR# || '%')
		]]>	
	</isNotEmpty>	
	<isNotEmpty prepend="AND" property="deptid">
		<![CDATA[		   
		 t.APPLYORDEPTID=#deptid:VARCHAR#
		]]>	
	</isNotEmpty>		
	<isNotEmpty prepend="AND" property="cpnyId">
		<![CDATA[		   
		 e.CPNY_ID=#cpnyId:VARCHAR#
		]]>	
	</isNotEmpty>	
	<isNotEmpty prepend="AND" property="startDate">
		<![CDATA[		   
		 t.USEDATE>=to_date(#startDate:VARCHAR#,'yyyy-mm-dd') 
		]]>	
	</isNotEmpty>
	<isNotEmpty prepend="AND" property="endDate">
		<![CDATA[		   
		 t.USEDATE<=to_date(#endDate:VARCHAR#,'yyyy-mm-dd') 
		]]>	
	</isNotEmpty>
	<![CDATA[
 order by t.documentno desc
  ]]>  
</select>
<select id="visaAffirmAndInformationListNumber" parameterClass="SimpleMap" resultClass="int">
  <![CDATA[	
    select count(t.documentno) as documentno  
from ga_visa_apply t , hr_employee e,
(SELECT GA_VISA_AFFIRM.*,
               UP_AFFIRM.AFFIRMOR_ID UP_AFFIRMOR_ID,
               NVL(UP_AFFIRM.AFFIRM_FLAG, 1) UP_AFFIRM_FLAG,
               CASE
                 WHEN GA_VISA_AFFIRM.AFFIRM_LEVEL =
                      MAX_AFFIRM.MAX_LEVEL THEN
                  1
                 ELSE
                  0
               END AS MAX_LEVEL_FLAG
          FROM (SELECT GA_VISA_AFFIRM.*,
                       GA_VISA_AFFIRM.AFFIRM_LEVEL - 1 UP_LEVEL,
                       GA_VISA_AFFIRM.AFFIRM_LEVEL + 1 NEXT_LEVEL
                  FROM GA_VISA_AFFIRM) GA_VISA_AFFIRM,
               (SELECT GA_VISA_AFFIRM.APPLY_NO,
                       GA_VISA_AFFIRM.AFFIRM_LEVEL,
                       GA_VISA_AFFIRM.AFFIRMOR_ID,
                       GA_VISA_AFFIRM.AFFIRM_FLAG
                  FROM GA_VISA_AFFIRM) UP_AFFIRM,
               (SELECT GA_VISA_AFFIRM.APPLY_NO,
                       MAX(GA_VISA_AFFIRM.AFFIRM_LEVEL) MAX_LEVEL
                  FROM GA_VISA_AFFIRM
                 GROUP BY GA_VISA_AFFIRM.APPLY_NO) MAX_AFFIRM
         WHERE GA_VISA_AFFIRM.APPLY_NO = UP_AFFIRM.APPLY_NO(+)
           AND GA_VISA_AFFIRM.UP_LEVEL = UP_AFFIRM.AFFIRM_LEVEL(+)
           AND GA_VISA_AFFIRM.APPLY_NO = MAX_AFFIRM.APPLY_NO(+)
           and GA_VISA_AFFIRM.affirmor_id = #applerId:VARCHAR#) AFFIRM
where   AFFIRM.UP_AFFIRM_FLAG=1
   and t.DOCUMENTNO=AFFIRM.APPLY_NO and e.person_id=t.applyorid
   and t.DOCUMENTNO in
       (select distinct a.apply_no
          from GA_VISA_AFFIRM a
         where a.affirmor_id = #applerId:VARCHAR#
           ]]>
   <isEqual prepend="AND" property="qryType" compareValue="0"> <!-- 未决裁过的 -->
		<![CDATA[
				 a.affirm_flag=0
	]]>
	</isEqual>
	<isEqual prepend="AND" property="qryType" compareValue="1"> <!-- 决裁通过的 -->
		<![CDATA[
				 a.affirm_flag =1
	]]>
	</isEqual>
	<isEqual prepend="AND" property="qryType" compareValue="2"> <!-- 决裁否决的 -->
		<![CDATA[
				 a.affirm_flag =2
	]]>
	</isEqual>
  <![CDATA[	
   )
   ]]>
   <isEmpty prepend="AND" property="qryType">
		<![CDATA[		   
		 a.affirm_flag=0
		]]>	
	</isEmpty>
	<isNotEmpty prepend="AND" property="key">
		<![CDATA[		   
		 (e.chinesename LIKE  '%'||#key:VARCHAR# || '%'  or t.APPLYORID LIKE  '%'||#key:VARCHAR# || '%')
		]]>	
	</isNotEmpty>	
	<isNotEmpty prepend="AND" property="deptid">
		<![CDATA[		   
		 t.APPLYORDEPTID=#deptid:VARCHAR#
		]]>	
	</isNotEmpty>		
	<isNotEmpty prepend="AND" property="cpnyId">
		<![CDATA[		   
		 e.CPNY_ID=#cpnyId:VARCHAR#
		]]>	
	</isNotEmpty>	
	<isNotEmpty prepend="AND" property="startDate">
		<![CDATA[		   
		 t.USEfDATE>=to_date(#startDate:VARCHAR#,'yyyy-mm-dd') 
		]]>	
	</isNotEmpty>
	<isNotEmpty prepend="AND" property="endDate">
		<![CDATA[		   
		 t.USEfDATE<=to_date(#endDate:VARCHAR#,'yyyy-mm-dd') 
		]]>	
	</isNotEmpty>
	<![CDATA[
 order by t.documentno desc
  ]]>  
</select>
<select id="sealAffirmAndInformationList" parameterClass="SimpleMap" resultClass="SimpleMap">
  <![CDATA[	
select t.documentno,
	hr.chinesename,
	hr.cpny_id,
	to_char(t.usedate,'yyyy-mm-dd') usedate, 
    t.usesealtype sealtype,
	code.code_name,
	t.SELECTDEPTID as deptname,
     CASE WHEN 
       T.islend=1
       THEN '是'
       ELSE '否'
       END islend,
	t.APPLYORID,
	ad.deptname as applydeptname,
	t.useinformation,
	t.useshares,
	t.note,
	t.DRAFT_NO,
	t.isconfirm,
	AFFIRM.AFFIRM_FLAG as AFFIRM_FLAG,
	T.ACTIVE,
    AFFIRM.AFFIRM_FLAG as AFFIRM_FLAG,
    t.FILENAME,
    t.FILEPATH,
    to_char(t.returndate, 'YYYY-MM-DD') as RETURNDATE
from ga_seal_apply t ,hr_employee hr, sy_code code,hr_department ad,
(SELECT GA_SEAL_AFFIRM.*,
               UP_AFFIRM.AFFIRMOR_ID UP_AFFIRMOR_ID,
               NVL(UP_AFFIRM.AFFIRM_FLAG, 1) UP_AFFIRM_FLAG,
               CASE
                 WHEN GA_SEAL_AFFIRM.AFFIRM_LEVEL =
                      MAX_AFFIRM.MAX_LEVEL THEN
                  1
                 ELSE
                  0
               END AS MAX_LEVEL_FLAG
          FROM (SELECT GA_SEAL_AFFIRM.*,
                       GA_SEAL_AFFIRM.AFFIRM_LEVEL - 1 UP_LEVEL,
                       GA_SEAL_AFFIRM.AFFIRM_LEVEL + 1 NEXT_LEVEL
                  FROM GA_SEAL_AFFIRM) GA_SEAL_AFFIRM,
               (SELECT GA_SEAL_AFFIRM.APPLY_NO,
                       GA_SEAL_AFFIRM.AFFIRM_LEVEL,
                       GA_SEAL_AFFIRM.AFFIRMOR_ID,
                       GA_SEAL_AFFIRM.AFFIRM_FLAG
                  FROM GA_SEAL_AFFIRM) UP_AFFIRM,
               (SELECT GA_SEAL_AFFIRM.APPLY_NO,
                       MAX(GA_SEAL_AFFIRM.AFFIRM_LEVEL) MAX_LEVEL
                  FROM GA_SEAL_AFFIRM
                 GROUP BY GA_SEAL_AFFIRM.APPLY_NO) MAX_AFFIRM
         WHERE GA_SEAL_AFFIRM.APPLY_NO = UP_AFFIRM.APPLY_NO(+)
           AND GA_SEAL_AFFIRM.UP_LEVEL = UP_AFFIRM.AFFIRM_LEVEL(+)
           AND GA_SEAL_AFFIRM.APPLY_NO = MAX_AFFIRM.APPLY_NO(+)
           and GA_SEAL_AFFIRM.affirmor_id = #applerId:VARCHAR#) AFFIRM
where t.applyorid=hr.person_id(+) 
	 and t.applyordeptid=ad.deptid(+)
	 and t.usesealtype=code.code_id(+)
	 AND AFFIRM.UP_AFFIRM_FLAG=1
   and t.DOCUMENTNO=AFFIRM.APPLY_NO
   and t.DOCUMENTNO in
       (select distinct a.apply_no
          from GA_SEAL_AFFIRM a
         where a.affirmor_id = #applerId:VARCHAR#
           ]]>
   <isEqual prepend="AND" property="qryType" compareValue="0"> <!-- 未决裁过的 -->
		<![CDATA[
				 a.affirm_flag=0
	]]>
	</isEqual>
	<isEqual prepend="AND" property="qryType" compareValue="1"> <!-- 决裁通过的 -->
		<![CDATA[
				 a.affirm_flag =1
	]]>
	</isEqual>
	<isEqual prepend="AND" property="qryType" compareValue="2"> <!-- 决裁否决的 -->
		<![CDATA[
				 a.affirm_flag =2
	]]>
	</isEqual>
	<isEmpty prepend="AND" property="qryType">
		<![CDATA[		   
		 a.affirm_flag=0
		]]>	
	</isEmpty>
  <![CDATA[	
   )
   ]]>	
      <isEmpty prepend="AND" property="qryType">
		<![CDATA[		   
		 a.affirm_flag=0
		]]>	
	</isEmpty>
	<isNotEmpty prepend="AND" property="key">
		<![CDATA[		   
		 (hr.chinesename LIKE  '%'||#key:VARCHAR# || '%'  or t.APPLYORID LIKE  '%'||#key:VARCHAR# || '%')
		]]>	
	</isNotEmpty>	
	<isNotEmpty prepend="AND" property="deptid">
		<![CDATA[		   
		 t.APPLYORDEPTID=#deptid:VARCHAR#
		]]>	
	</isNotEmpty>	
	<isNotEmpty prepend="AND" property="cpnyId">
		<![CDATA[		   
		 ad.CPNY_ID=#cpnyId:VARCHAR#
		]]>	
	</isNotEmpty>	
	<isNotEmpty prepend="AND" property="startDate">
		<![CDATA[		   
		 t.USEDATE>=to_date(#startDate:VARCHAR#,'yyyy-mm-dd') 
		]]>	
	</isNotEmpty>
	<isNotEmpty prepend="AND" property="endDate">
		<![CDATA[		   
		 t.USEDATE<=to_date(#endDate:VARCHAR#,'yyyy-mm-dd') 
		]]>	
	</isNotEmpty>
	<![CDATA[
 order by t.documentno desc
  ]]>
</select>
<select id="visaAffirmAndInformationList" parameterClass="SimpleMap" resultClass="SimpleMap">
  <![CDATA[	
select t.documentno,t.applydate,
  hr.chinesename,
  hr.cpny_id,
  to_char(t.usefdate,'yyyy-mm-dd') usefdate, 
  to_char(t.usetdate,'yyyy-mm-dd') usetdate, 
     CASE WHEN 
       t.usevisatype=1
       THEN '多次'
       ELSE '单次'
       END  sealtype,
  t.SELECTDEPTID as deptname,
     CASE WHEN 
       T.islend=1
       THEN '加急（2个工作日）'
       ELSE '普通（10个工作日）'
       END islend,
  t.APPLYORID,
  ad.deptname as applydeptname,
  t.useinformation,
  t.useshares,
  t.note,
  t.DRAFT_NO,
  t.isconfirm,
  AFFIRM.AFFIRM_FLAG as AFFIRM_FLAG,
  T.ACTIVE,
    AFFIRM.AFFIRM_FLAG as AFFIRM_FLAG,
    t.FILENAME,
    t.FILEPATH,
    to_char(t.returndate, 'YYYY-MM-DD') as RETURNDATE
from ga_visa_apply t ,hr_employee hr, hr_department ad,
(SELECT GA_VISA_AFFIRM.*,
               UP_AFFIRM.AFFIRMOR_ID UP_AFFIRMOR_ID,
               NVL(UP_AFFIRM.AFFIRM_FLAG, 1) UP_AFFIRM_FLAG,
               CASE
                 WHEN GA_VISA_AFFIRM.AFFIRM_LEVEL =
                      MAX_AFFIRM.MAX_LEVEL THEN
                  1
                 ELSE
                  0
               END AS MAX_LEVEL_FLAG
          FROM (SELECT GA_VISA_AFFIRM.*,
                       GA_VISA_AFFIRM.AFFIRM_LEVEL - 1 UP_LEVEL,
                       GA_VISA_AFFIRM.AFFIRM_LEVEL + 1 NEXT_LEVEL
                  FROM GA_VISA_AFFIRM) GA_VISA_AFFIRM,
               (SELECT GA_VISA_AFFIRM.APPLY_NO,
                       GA_VISA_AFFIRM.AFFIRM_LEVEL,
                       GA_VISA_AFFIRM.AFFIRMOR_ID,
                       GA_VISA_AFFIRM.AFFIRM_FLAG
                  FROM GA_VISA_AFFIRM) UP_AFFIRM,
               (SELECT GA_VISA_AFFIRM.APPLY_NO,
                       MAX(GA_VISA_AFFIRM.AFFIRM_LEVEL) MAX_LEVEL
                  FROM GA_VISA_AFFIRM
                 GROUP BY GA_VISA_AFFIRM.APPLY_NO) MAX_AFFIRM
         WHERE GA_VISA_AFFIRM.APPLY_NO = UP_AFFIRM.APPLY_NO(+)
           AND GA_VISA_AFFIRM.UP_LEVEL = UP_AFFIRM.AFFIRM_LEVEL(+)
           AND GA_VISA_AFFIRM.APPLY_NO = MAX_AFFIRM.APPLY_NO(+)
           and GA_VISA_AFFIRM.affirmor_id = #applerId:VARCHAR#           ) AFFIRM
where t.applyorid=hr.person_id(+) 
   and t.applyordeptid=ad.deptid(+)
   AND AFFIRM.UP_AFFIRM_FLAG=1
   and t.DOCUMENTNO=AFFIRM.APPLY_NO
   and t.DOCUMENTNO in
       (select distinct a.apply_no
          from GA_VISA_AFFIRM a
         where a.affirmor_id = #applerId:VARCHAR#
           ]]>
   <isEqual prepend="AND" property="qryType" compareValue="0"> <!-- 未决裁过的 -->
		<![CDATA[
				 a.affirm_flag=0
	]]>
	</isEqual>
	<isEqual prepend="AND" property="qryType" compareValue="1"> <!-- 决裁通过的 -->
		<![CDATA[
				 a.affirm_flag =1
	]]>
	</isEqual>
	<isEqual prepend="AND" property="qryType" compareValue="2"> <!-- 决裁否决的 -->
		<![CDATA[
				 a.affirm_flag =2
	]]>
	</isEqual>
	<isEmpty prepend="AND" property="qryType">
		<![CDATA[		   
		 a.affirm_flag=0
		]]>	
	</isEmpty>
  <![CDATA[	
   )
   ]]>	
      <isEmpty prepend="AND" property="qryType">
		<![CDATA[		   
		 a.affirm_flag=0
		]]>	
	</isEmpty>
	<isNotEmpty prepend="AND" property="key">
		<![CDATA[		   
		 (hr.chinesename LIKE  '%'||#key:VARCHAR# || '%'  or t.APPLYORID LIKE  '%'||#key:VARCHAR# || '%')
		]]>	
	</isNotEmpty>	
	<isNotEmpty prepend="AND" property="deptid">
		<![CDATA[		   
		 t.APPLYORDEPTID=#deptid:VARCHAR#
		]]>	
	</isNotEmpty>	
	<isNotEmpty prepend="AND" property="cpnyId">
		<![CDATA[		   
		 ad.CPNY_ID=#cpnyId:VARCHAR#
		]]>	
	</isNotEmpty>	
	<isNotEmpty prepend="AND" property="startDate">
		<![CDATA[		   
		 t.USEFDATE>=to_date(#startDate:VARCHAR#,'yyyy-mm-dd') 
		]]>	
	</isNotEmpty>
	<isNotEmpty prepend="AND" property="endDate">
		<![CDATA[		   
		 t.USEFDATE<=to_date(#endDate:VARCHAR#,'yyyy-mm-dd') 
		]]>	
	</isNotEmpty>
	<![CDATA[
 order by t.documentno desc
  ]]>
</select>
<select id="sealAffirmAndInformationAffirmorList" parameterClass="SimpleMap" resultClass="SimpleMap">
  <![CDATA[	
select  
     t.ga_affirm_no ,t.affirm_flag,t.affirm_level,t.affirmor_id,hr.chinesename,hr.person_id,t.AFFIRMORIDEA,t.read_flag,
     CASE WHEN 
       T.AFFIRM_LEVEL=MAX_AFFIRM_TABLE.MAX_AFFIRM_LEVEL
       THEN 1
       ELSE 0
       END MAX_AFFIRM_FLAG,
     CASE WHEN 
       T.read_flag=1
       THEN '已查看'
       ELSE '未查看'
       END read_flag_name,
       to_char(t.UPDATE_DATE,'YYYY-MM-DD HH24:MI') as UPDATE_DATE  
from ga_seal_affirm t,hr_employee hr,
(select  max(affirm.affirm_level) MAX_AFFIRM_LEVEL
          from GA_SEAL_AFFIRM affirm
         WHERE affirm.apply_no=#applyno:VARCHAR#
        ) MAX_AFFIRM_TABLE
where t.affirmor_id=hr.person_id
      and t.apply_no=#applyno:VARCHAR#
order by t.affirm_level
  ]]>
</select>
<select id="visaAffirmAndInformationAffirmorList" parameterClass="SimpleMap" resultClass="SimpleMap">
  <![CDATA[	
select  
     t.ga_affirm_no ,t.affirm_flag,t.affirm_level,t.affirmor_id,hr.chinesename,hr.person_id,t.AFFIRMORIDEA,t.read_flag,
     CASE WHEN 
       T.AFFIRM_LEVEL=MAX_AFFIRM_TABLE.MAX_AFFIRM_LEVEL
       THEN 1
       ELSE 0
       END MAX_AFFIRM_FLAG,
     CASE WHEN 
       T.read_flag=1
       THEN '已查看'
       ELSE '未查看'
       END read_flag_name,
       to_char(t.UPDATE_DATE,'YYYY-MM-DD HH24:MI') as UPDATE_DATE  
from ga_visa_affirm t,hr_employee hr,
(select  max(affirm.affirm_level) MAX_AFFIRM_LEVEL
          from GA_VISA_AFFIRM affirm
         WHERE affirm.apply_no=#applyno:VARCHAR#
        ) MAX_AFFIRM_TABLE
where t.affirmor_id=hr.person_id
      and t.apply_no=#applyno:VARCHAR#
order by t.affirm_level
  ]]>
</select>

<update id="ongingAffirm" parameterClass="SimpleMap">
  <![CDATA[	
update ga_seal_affirm t
set t.affirm_flag=#flag:VARCHAR#
where t.ga_affirm_no=#affirmno:VARCHAR#
    ]]>
</update>

<update id="ongingDelete" parameterClass="SimpleMap">
  <![CDATA[	
update ga_seal_apply t
set t.active=#flag:VARCHAR#
where t.documentno=#applyno:VARCHAR#
    ]]>
</update>

<update id="ongingRead" parameterClass="SimpleMap">
  <![CDATA[	
	update ga_seal_affirm t
    set t.READ_FLAG=1
    where t.apply_no = #documentno:VARCHAR# 
      and t.affirmor_id = #applerId:VARCHAR#
    ]]>
</update>

<update id="updateAffirmFlag" parameterClass="SimpleMap">
  <![CDATA[	
update GA_SEAL_AFFIRM 
set AFFIRM_FLAG = #flag:NUMERIC#,
    AFFIRMORIDEA=#affirmorIdea:varchar#,
    UPDATE_DATE=SYSDATE,
    UPDATED_BY=#adminId:varchar#
where GA_AFFIRM_NO = #affirmNo:NUMERIC#
    ]]>
</update>
<update id="updateAffirmFlagV" parameterClass="SimpleMap">
  <![CDATA[	
update GA_VISA_AFFIRM 
set AFFIRM_FLAG = #flag:NUMERIC#,
    AFFIRMORIDEA=#affirmorIdea:varchar#,
    UPDATE_DATE=SYSDATE,
    UPDATED_BY=#adminId:varchar#
where GA_AFFIRM_NO = #affirmNo:NUMERIC#
    ]]>
</update>

<update id="confirmSealApply" parameterClass="SimpleMap">
  <![CDATA[	
			 update GA_SEAL_APPLY set active = #flag:NUMERIC#
         		where DOCUMENTNO = #applyno:NUMERIC#
    ]]>
</update>
<update id="confirmVisaApply" parameterClass="SimpleMap">
  <![CDATA[	
			 update GA_VISA_APPLY set active = #flag:NUMERIC#
         		where DOCUMENTNO = #applyno:NUMERIC#
    ]]>
</update>

<update id="confirmSealApplyForDISD" parameterClass="SimpleMap">
  <![CDATA[	
			 update GA_SEAL_APPLY set active = #flag:NUMERIC#,isconfirm = #flag:NUMERIC#
         		where DOCUMENTNO = #applyno:NUMERIC#
    ]]>
</update>

<select id="allsealAffrimInfoList" parameterClass="SimpleMap" resultClass="SimpleMap">
  <![CDATA[	
	select seal.documentno,
       e.chinesename,
       seal.APPLYORID,
       hr1.chinesename as CONFIRORANDSENDORNAME,
       t.deptname as APPLYDEPTNAME,
       to_char(seal.usedate, 'YYYY-MM-DD') as USEDATE,
       get_code_name(seal.USESEALTYPE) as USESEALTYPE,
       seal.SELECTDEPTID as SELECTDEPTID,
 	   CASE WHEN seal.islend=1
       THEN '是'  ELSE '否'
       END ISLEND,
       USEINFORMATION,
       USESHARES,
       DRAFT_NO,
       NOTE,
       seal.ISCONFIRM,
       seal.FILENAME,
       seal.FILEPATH,
       to_char(seal.returndate, 'YYYY-MM-DD') as RETURNDATE
  from GA_SEAL_APPLY seal, hr_department t, hr_employee e,HR_EMPLOYEE HR1
 where seal.applyordeptid = t.deptid and HR1.PERSON_ID(+)=seal.CONFIRMORID
   and seal.applyorid = e.person_id
   and seal.documentno in (select distinct  a.apply_no from GA_SEAL_AFFIRM a where a.activity =1)
  ]]>
   <isNotEmpty prepend="AND" property="ADMIN_ID">
		<![CDATA[
			EXISTS ( SELECT SAD.ADMIN_DEPTID
				   FROM SY_ADMIN_DEPTID SAD, SY_ADMIN SA
				  WHERE SAD.ADMIN_NO = SA.ADMINNO
				    AND SA.ADMINID = #ADMIN_ID:VARCHAR2#
				    AND SAD.ADMIN_DEPTID = seal.APPLYORDEPTID	
			   ) 
		]]>
	</isNotEmpty>
	<isNotEmpty prepend="AND" property="adminId">
			<![CDATA[		
			   seal.APPLYORID = #adminId:VARCHAR2#
		]]>
		</isNotEmpty>
  <isEqual prepend="AND" property="qryType" compareValue="0"> <!-- 未决裁过的 -->
	<![CDATA[
				 seal.ISCONFIRM=0
	]]>
	</isEqual>
	<isEqual prepend="AND" property="qryType" compareValue="1"> <!-- 决裁通过的 -->
	<![CDATA[
				 seal.ISCONFIRM =1
	]]>
	</isEqual>
	<isNotEmpty prepend="AND" property="key">
		<![CDATA[		   
		 (e.empid LIKE  '%'||#key:VARCHAR# || '%' or e.chinesename LIKE  '%'||#key:VARCHAR# || '%')
		]]>	
	</isNotEmpty>
	<isNotEmpty prepend="AND" property="key2">
		<![CDATA[		   
		 (seal.SELECTDEPTID LIKE  '%'||#key2:VARCHAR# || '%' )
		]]>	
	</isNotEmpty>	
	<isNotEmpty prepend="AND" property="key3">
		<![CDATA[		   
		 (seal.USEINFORMATION LIKE  '%'||#key3:VARCHAR# || '%' )
		]]>	
	</isNotEmpty>
	<isNotEmpty  property="qryType2">
		<isNotEqual prepend="AND" property="qryType2" compareValue="SealType_Code00"> <!-- 请点击下拉条准确选择印章类型 -->
		<![CDATA[
					 (seal.USESEALTYPE LIKE  '%'||#qryType2:VARCHAR# || '%'  )
		]]>
		</isNotEqual>	
	</isNotEmpty>
	<isNotEmpty prepend="AND"  property="codeName">
		<![CDATA[
				(get_code_name(seal.USESEALTYPE) LIKE  '%'||#codeName:VARCHAR# || '%'  )
		]]>		
	</isNotEmpty>
	<isNotEmpty prepend="AND" property="qryType3">
		<![CDATA[		   
		 (seal.ISLEND =  #qryType3:VARCHAR# )
		]]>	
	</isNotEmpty>			
	<isNotEmpty prepend="AND" property="deptid">
		<![CDATA[		   
		 seal.APPLYORDEPTID=#deptid:VARCHAR#
		]]>	
	</isNotEmpty>	
	<isNotEmpty prepend="AND" property="cpnyId">
		<![CDATA[		   
		 t.CPNY_ID=#cpnyId:VARCHAR#
		]]>	
	</isNotEmpty>
	<isNotEmpty prepend="AND" property="startDate">
		<![CDATA[		   
		 seal.USEDATE >= to_date(#startDate:VARCHAR#,'YYYY-MM-DD')
		]]>	
	</isNotEmpty>	
	<isNotEmpty prepend="AND" property="endDate">
		<![CDATA[		   
		 seal.USEDATE <=to_date(#endDate:VARCHAR#,'YYYY-MM-DD')
		]]>	
	</isNotEmpty>	
	
	<![CDATA[
 order by seal.documentno desc
  ]]>  
	
</select>

<select id="allsealAffrimInfoInt" parameterClass="SimpleMap" resultClass="int">
  <![CDATA[	
	select count(*)
  from GA_SEAL_APPLY seal,hr_employee e
 where seal.applyorid = e.person_id
   and seal.documentno in (select distinct  a.apply_no from GA_SEAL_AFFIRM a where a.activity =1)
  ]]>
  <isNotEmpty prepend="AND" property="ADMIN_ID">
		<![CDATA[
			EXISTS ( SELECT SAD.ADMIN_DEPTID
				   FROM SY_ADMIN_DEPTID SAD, SY_ADMIN SA
				  WHERE SAD.ADMIN_NO = SA.ADMINNO
				    AND SA.ADMINID = #ADMIN_ID:VARCHAR2#
				    AND SAD.ADMIN_DEPTID = seal.APPLYORDEPTID	
			   ) 
		]]>
	</isNotEmpty>
	<isNotEmpty prepend="AND" property="adminId">
			<![CDATA[		
			   seal.APPLYORID = #adminId:VARCHAR2#
		]]>
		</isNotEmpty>
  <isEqual prepend="AND" property="qryType" compareValue="0"> <!-- 未决裁过的 -->
	<![CDATA[
				 seal.ISCONFIRM=0
	]]>
	</isEqual>
	<isEqual prepend="AND" property="qryType" compareValue="1"> <!-- 决裁通过的 -->
	<![CDATA[
				 seal.ISCONFIRM =1
	]]>
	</isEqual>
	<isNotEmpty prepend="AND" property="key">
		<![CDATA[		   
		 (e.empid LIKE  '%'||#key:VARCHAR# || '%' or e.chinesename LIKE  '%'||#key:VARCHAR# || '%')
		]]>	
	</isNotEmpty>
	<isNotEmpty prepend="AND" property="key2">
		<![CDATA[		   
		 (seal.SELECTDEPTID LIKE  '%'||#key2:VARCHAR# || '%' )
		]]>	
	</isNotEmpty>	
	<isNotEmpty prepend="AND" property="key3">
		<![CDATA[		   
		 (seal.USEINFORMATION LIKE  '%'||#key3:VARCHAR# || '%' )
		]]>	
	</isNotEmpty>
	 
	<isNotEmpty  property="qryType2">
		<isNotEqual prepend="AND" property="qryType2" compareValue="SealType_Code00"> <!-- 未决裁过的 -->
		<![CDATA[
					 (seal.USESEALTYPE LIKE  '%'||#qryType2:VARCHAR# || '%'  )
		]]>
		</isNotEqual>	
	</isNotEmpty>
	<isNotEmpty prepend="AND" property="qryType3">
		<![CDATA[		   
		 (seal.ISLEND =  #qryType3:VARCHAR# )
		]]>	
	</isNotEmpty>		
	<isNotEmpty prepend="AND" property="deptid">
		<![CDATA[		   
		 seal.APPLYORDEPTID=#deptid:VARCHAR#
		]]>	
	</isNotEmpty>	
	<isNotEmpty prepend="AND" property="cpnyId">
		<![CDATA[		   
		 e.CPNY_ID=#cpnyId:VARCHAR#
		]]>	
	</isNotEmpty>	
	
	<isNotEmpty prepend="AND" property="startDate">
		<![CDATA[		   
		 seal.USEDATE >= to_date(#startDate:VARCHAR#,'YYYY-MM-DD')
		]]>	
	</isNotEmpty>	
	<isNotEmpty prepend="AND" property="endDate">
		<![CDATA[		   
		 seal.USEDATE <=to_date(#endDate:VARCHAR#,'YYYY-MM-DD')
		]]>	
	</isNotEmpty>		
</select>

<select id="allvisaAffrimInfoList" parameterClass="SimpleMap" resultClass="SimpleMap">
  <![CDATA[	
	select seal.documentno,
       e.chinesename,
       seal.APPLYORID,
       hr1.chinesename as CONFIRORANDSENDORNAME,
       t.deptname as APPLYDEPTNAME,
       to_char(seal.usefdate, 'YYYY-MM-DD') as USEFDATE,
       ceil(USEFDATE-RETURNDATE) as USETDATE,
        CASE WHEN seal.USEvisaTYPE=1
       THEN '多次'  ELSE '单次'
       END USEVISATYPE,
       seal.SELECTDEPTID as SELECTDEPTID,
 	   CASE WHEN seal.islend=1
       THEN '加急（2个工作日）'  ELSE '普通（10个工作日）'
       END ISLEND,
       USEINFORMATION,
       USESHARES,
       DRAFT_NO,
       NOTE,
       seal.ISCONFIRM,
       seal.FILENAME,
       seal.FILEPATH,
       seal.MANYZH,
        seal.MANYFW,
         seal.MANYNQ,
        CASE WHEN seal.ISCOMPLISE=1
       THEN '已完成' WHEN seal.ISCOMPLISE=2 THEN '拒签' ELSE '未完成'
       END ISCOMPLISE,
       to_char(seal.returndate, 'YYYY-MM-DD') as RETURNDATE
  from GA_VISA_APPLY seal, hr_department t, hr_employee e,HR_EMPLOYEE HR1
 where seal.applyordeptid = t.deptid and HR1.PERSON_ID(+)=seal.CONFIRMORID
   and seal.applyorid = e.person_id
   and seal.documentno in (select distinct  a.apply_no from GA_VISA_AFFIRM a where a.activity =1)
  ]]>
   <isNotEmpty prepend="AND" property="ADMIN_ID">
		<![CDATA[
			EXISTS ( SELECT SAD.ADMIN_DEPTID
				   FROM SY_ADMIN_DEPTID SAD, SY_ADMIN SA
				  WHERE SAD.ADMIN_NO = SA.ADMINNO
				    AND SA.ADMINID = #ADMIN_ID:VARCHAR2#
				    AND SAD.ADMIN_DEPTID = seal.APPLYORDEPTID	
			   ) 
		]]>
	</isNotEmpty>
	<isNotEmpty prepend="AND" property="adminId">
			<![CDATA[		
			   seal.APPLYORID = #adminId:VARCHAR2#
		]]>
		</isNotEmpty>
  <isEqual prepend="AND" property="qryType" compareValue="0"> <!-- 未决裁过的 -->
	<![CDATA[
				 seal.ISCOMPLISE=0
	]]>
	</isEqual>
	<isEqual prepend="AND" property="qryType" compareValue="1"> <!-- 决裁通过的 -->
	<![CDATA[
				 seal.ISCOMPLISE =1
	]]>
	</isEqual>
	<isEqual prepend="AND" property="qryType" compareValue="2"> <!-- 决裁通过的 -->
	<![CDATA[
				 seal.ISCOMPLISE =2
	]]>
	</isEqual>
	<isNotEmpty prepend="AND" property="key">
		<![CDATA[		   
		 (e.empid LIKE  '%'||#key:VARCHAR# || '%' or e.chinesename LIKE  '%'||#key:VARCHAR# || '%')
		]]>	
	</isNotEmpty>
	<isNotEmpty prepend="AND" property="key2">
		<![CDATA[		   
		 (seal.SELECTDEPTID LIKE  '%'||#key2:VARCHAR# || '%' )
		]]>	
	</isNotEmpty>	
	<isNotEmpty prepend="AND" property="key3">
		<![CDATA[		   
		 (seal.USEINFORMATION LIKE  '%'||#key3:VARCHAR# || '%' )
		]]>	
	</isNotEmpty>
	<isNotEmpty   prepend="AND"  property="qryType2">		
		<![CDATA[
					 (seal.USEVISATYPE LIKE  '%'||#qryType2:VARCHAR# || '%'  )
		]]>		
	</isNotEmpty>
	<isNotEmpty prepend="AND"  property="codeName">
		<![CDATA[
				(get_code_name(seal.USESEALTYPE) LIKE  '%'||#codeName:VARCHAR# || '%'  )
		]]>		
	</isNotEmpty>
	<isNotEmpty prepend="AND" property="qryType3">
		<![CDATA[		   
		 (seal.ISLEND =  #qryType3:VARCHAR# )
		]]>	
	</isNotEmpty>			
	<isNotEmpty prepend="AND" property="deptid">
		<![CDATA[		   
		 seal.APPLYORDEPTID=#deptid:VARCHAR#
		]]>	
	</isNotEmpty>	
	<isNotEmpty prepend="AND" property="cpnyId">
		<![CDATA[		   
		 t.CPNY_ID=#cpnyId:VARCHAR#
		]]>	
	</isNotEmpty>
	<isNotEmpty prepend="AND" property="startDate">
		<![CDATA[		   
		 seal.USEfDATE >= to_date(#startDate:VARCHAR#,'YYYY-MM-DD')
		]]>	
	</isNotEmpty>	
	<isNotEmpty prepend="AND" property="endDate">
		<![CDATA[		   
		 seal.USEfDATE <=to_date(#endDate:VARCHAR#,'YYYY-MM-DD')
		]]>	
	</isNotEmpty>	
	
	<![CDATA[
 order by seal.documentno desc
  ]]>  
	
</select>
<select id="allvisaAffrimInfoListall" parameterClass="SimpleMap" resultClass="SimpleMap">
  <![CDATA[	
	select seal.documentno,
       e.chinesename,
       seal.APPLYORID,
       hr1.chinesename as CONFIRORANDSENDORNAME,
       t.deptname as APPLYDEPTNAME,
       to_char(seal.usefdate, 'YYYY-MM-DD') as USEFDATE,
       ceil(USEFDATE-RETURNDATE) as USETDATE,
        CASE WHEN seal.USEvisaTYPE=1
       THEN '多次'  ELSE '单次'
       END USEVISATYPE,
       seal.SELECTDEPTID as SELECTDEPTID,
 	   CASE WHEN seal.islend=1
       THEN '加急（2个工作日）'  ELSE '普通（10个工作日）'
       END ISLEND,
       USEINFORMATION,
       USESHARES,
       DRAFT_NO,
       NOTE,
       seal.ISCONFIRM,
       seal.FILENAME,
       seal.FILEPATH,
       seal.MANYZH,
        seal.MANYFW,
         seal.MANYNQ,
         CASE WHEN seal.ISCOMPLISE=1
       THEN '已完成'   WHEN seal.ISCOMPLISE=2 THEN '拒签' ELSE '未完成'
       END ISCOMPLISE,
       to_char(seal.returndate, 'YYYY-MM-DD') as RETURNDATE
  from GA_VISA_APPLY seal, hr_department t, hr_employee e,HR_EMPLOYEE HR1
 where seal.applyordeptid = t.deptid and HR1.PERSON_ID(+)=seal.CONFIRMORID
   and seal.applyorid = e.person_id
   and seal.documentno in (select distinct  a.apply_no from GA_VISA_AFFIRM a where a.activity =1)
  ]]>
   <isEqual prepend="AND" property="qryType" compareValue="0"> <!-- 未决裁过的 -->
	<![CDATA[
				 seal.ISCOMPLISE=0
	]]>
	</isEqual>
	<isEqual prepend="AND" property="qryType" compareValue="1"> <!-- 决裁通过的 -->
	<![CDATA[
				 seal.ISCOMPLISE =1
	]]>
	</isEqual>
	<isEqual prepend="AND" property="qryType" compareValue="2"> <!-- 决裁通过的 -->
	<![CDATA[
				 seal.ISCOMPLISE =2
	]]>
	</isEqual>
	<isNotEmpty prepend="AND" property="key">
		<![CDATA[		   
		 (e.empid LIKE  '%'||#key:VARCHAR# || '%' or e.chinesename LIKE  '%'||#key:VARCHAR# || '%')
		]]>	
	</isNotEmpty>
	<isNotEmpty prepend="AND" property="key2">
		<![CDATA[		   
		 (seal.SELECTDEPTID LIKE  '%'||#key2:VARCHAR# || '%' )
		]]>	
	</isNotEmpty>	
	<isNotEmpty prepend="AND" property="key3">
		<![CDATA[		   
		 (seal.USEINFORMATION LIKE  '%'||#key3:VARCHAR# || '%' )
		]]>	
	</isNotEmpty>
	<isNotEmpty   prepend="AND"  property="qryType2">		
		<![CDATA[
					 (seal.USEVISATYPE LIKE  '%'||#qryType2:VARCHAR# || '%'  )
		]]>		
	</isNotEmpty>
	<isNotEmpty prepend="AND"  property="codeName">
		<![CDATA[
				(get_code_name(seal.USESEALTYPE) LIKE  '%'||#codeName:VARCHAR# || '%'  )
		]]>		
	</isNotEmpty>
	<isNotEmpty prepend="AND" property="qryType3">
		<![CDATA[		   
		 (seal.ISLEND =  #qryType3:VARCHAR# )
		]]>	
	</isNotEmpty>			
	<isNotEmpty prepend="AND" property="deptid">
		<![CDATA[		   
		 seal.APPLYORDEPTID=#deptid:VARCHAR#
		]]>	
	</isNotEmpty>	
	<isNotEmpty prepend="AND" property="cpnyId">
		<![CDATA[		   
		 t.CPNY_ID=#cpnyId:VARCHAR#
		]]>	
	</isNotEmpty>
	<isNotEmpty prepend="AND" property="startDate">
		<![CDATA[		   
		 seal.USEfDATE >= to_date(#startDate:VARCHAR#,'YYYY-MM-DD')
		]]>	
	</isNotEmpty>	
	<isNotEmpty prepend="AND" property="endDate">
		<![CDATA[		   
		 seal.USEfDATE <=to_date(#endDate:VARCHAR#,'YYYY-MM-DD')
		]]>	
	</isNotEmpty>	
	
	<![CDATA[
 order by seal.documentno desc
  ]]>  
	
</select>
<select id="allvisaAffrimInfoInt" parameterClass="SimpleMap" resultClass="int">
  <![CDATA[	
	select count(*)
  from GA_VISA_APPLY seal,hr_employee e
 where seal.applyorid = e.person_id
   and seal.documentno in (select distinct  a.apply_no from GA_VISA_AFFIRM a where a.activity =1)
  ]]>
  <isNotEmpty prepend="AND" property="ADMIN_ID">
		<![CDATA[
			EXISTS ( SELECT SAD.ADMIN_DEPTID
				   FROM SY_ADMIN_DEPTID SAD, SY_ADMIN SA
				  WHERE SAD.ADMIN_NO = SA.ADMINNO
				    AND SA.ADMINID = #ADMIN_ID:VARCHAR2#
				    AND SAD.ADMIN_DEPTID = seal.APPLYORDEPTID	
			   ) 
		]]>
	</isNotEmpty>
	<isNotEmpty prepend="AND" property="adminId">
			<![CDATA[		
			   seal.APPLYORID = #adminId:VARCHAR2#
		]]>
		</isNotEmpty>
  <isEqual prepend="AND" property="qryType" compareValue="0"> <!-- 未决裁过的 -->
	<![CDATA[
				 seal.ISCOMPLISE=0
	]]>
	</isEqual>
	<isEqual prepend="AND" property="qryType" compareValue="1"> <!-- 决裁通过的 -->
	<![CDATA[
				 seal.ISCOMPLISE =1
	]]>
	</isEqual>
	<isEqual prepend="AND" property="qryType" compareValue="2"> <!-- 决裁通过的 -->
	<![CDATA[
				 seal.ISCOMPLISE =2
	]]>
	</isEqual>
	<isNotEmpty prepend="AND" property="key">
		<![CDATA[		   
		 (e.empid LIKE  '%'||#key:VARCHAR# || '%' or e.chinesename LIKE  '%'||#key:VARCHAR# || '%')
		]]>	
	</isNotEmpty>
	<isNotEmpty prepend="AND" property="key2">
		<![CDATA[		   
		 (seal.SELECTDEPTID LIKE  '%'||#key2:VARCHAR# || '%' )
		]]>	
	</isNotEmpty>	
	<isNotEmpty prepend="AND" property="key3">
		<![CDATA[		   
		 (seal.USEINFORMATION LIKE  '%'||#key3:VARCHAR# || '%' )
		]]>	
	</isNotEmpty>
	 
	<isNotEmpty  property="qryType2">
		<isNotEqual prepend="AND" property="qryType2" compareValue="SealType_Code00"> <!-- 未决裁过的 -->
		<![CDATA[
					 (seal.USEVISATYPE LIKE  '%'||#qryType2:VARCHAR# || '%'  )
		]]>
		</isNotEqual>	
	</isNotEmpty>
	<isNotEmpty prepend="AND" property="qryType3">
		<![CDATA[		   
		 (seal.ISLEND =  #qryType3:VARCHAR# )
		]]>	
	</isNotEmpty>		
	<isNotEmpty prepend="AND" property="deptid">
		<![CDATA[		   
		 seal.APPLYORDEPTID=#deptid:VARCHAR#
		]]>	
	</isNotEmpty>	
	<isNotEmpty prepend="AND" property="cpnyId">
		<![CDATA[		   
		 e.CPNY_ID=#cpnyId:VARCHAR#
		]]>	
	</isNotEmpty>	
	
	<isNotEmpty prepend="AND" property="startDate">
		<![CDATA[		   
		 seal.USEfDATE >= to_date(#startDate:VARCHAR#,'YYYY-MM-DD')
		]]>	
	</isNotEmpty>	
	<isNotEmpty prepend="AND" property="endDate">
		<![CDATA[		   
		 seal.USEfDATE <=to_date(#endDate:VARCHAR#,'YYYY-MM-DD')
		]]>	
	</isNotEmpty>		
</select>
<select id="allvisaAffrimInfoIntall" parameterClass="SimpleMap" resultClass="int">
  <![CDATA[	
	select count(*)
  from GA_VISA_APPLY seal,hr_employee e
 where seal.applyorid = e.person_id
   and seal.documentno in (select distinct  a.apply_no from GA_VISA_AFFIRM a where a.activity =1)
  ]]>
  <isEqual prepend="AND" property="qryType" compareValue="0"> <!-- 未决裁过的 -->
	<![CDATA[
				 seal.ISCOMPLISE=0
	]]>
	</isEqual>
	<isEqual prepend="AND" property="qryType" compareValue="1"> <!-- 决裁通过的 -->
	<![CDATA[
				 seal.ISCOMPLISE =1
	]]>
	</isEqual>
	<isEqual prepend="AND" property="qryType" compareValue="2"> <!-- 决裁通过的 -->
	<![CDATA[
				 seal.ISCOMPLISE =2
	]]>
	</isEqual>
	<isNotEmpty prepend="AND" property="key">
		<![CDATA[		   
		 (e.empid LIKE  '%'||#key:VARCHAR# || '%' or e.chinesename LIKE  '%'||#key:VARCHAR# || '%')
		]]>	
	</isNotEmpty>
	<isNotEmpty prepend="AND" property="key2">
		<![CDATA[		   
		 (seal.SELECTDEPTID LIKE  '%'||#key2:VARCHAR# || '%' )
		]]>	
	</isNotEmpty>	
	<isNotEmpty prepend="AND" property="key3">
		<![CDATA[		   
		 (seal.USEINFORMATION LIKE  '%'||#key3:VARCHAR# || '%' )
		]]>	
	</isNotEmpty>
	 
	<isNotEmpty  property="qryType2">
		<isNotEqual prepend="AND" property="qryType2" compareValue="SealType_Code00"> <!-- 未决裁过的 -->
		<![CDATA[
					 (seal.USEVISATYPE LIKE  '%'||#qryType2:VARCHAR# || '%'  )
		]]>
		</isNotEqual>	
	</isNotEmpty>
	<isNotEmpty prepend="AND" property="qryType3">
		<![CDATA[		   
		 (seal.ISLEND =  #qryType3:VARCHAR# )
		]]>	
	</isNotEmpty>		
	<isNotEmpty prepend="AND" property="deptid">
		<![CDATA[		   
		 seal.APPLYORDEPTID=#deptid:VARCHAR#
		]]>	
	</isNotEmpty>	
	<isNotEmpty prepend="AND" property="cpnyId">
		<![CDATA[		   
		 e.CPNY_ID=#cpnyId:VARCHAR#
		]]>	
	</isNotEmpty>	
	
	<isNotEmpty prepend="AND" property="startDate">
		<![CDATA[		   
		 seal.USEfDATE >= to_date(#startDate:VARCHAR#,'YYYY-MM-DD')
		]]>	
	</isNotEmpty>	
	<isNotEmpty prepend="AND" property="endDate">
		<![CDATA[		   
		 seal.USEfDATE <=to_date(#endDate:VARCHAR#,'YYYY-MM-DD')
		]]>	
	</isNotEmpty>		
</select>
<select id="allSealApproval" parameterClass="SimpleMap" resultClass="SimpleMap">
  <![CDATA[	
	select t.ga_affirm_no,
       t.affirm_flag,
       t.apply_no,
       t.affirm_level,
       t.affirmor_id,
       hr.chinesename,
       CASE WHEN 
       T.AFFIRM_LEVEL=MAX_AFFIRM_TABLE.MAX_AFFIRM_LEVEL
       THEN 1
       ELSE 0
       END MAX_AFFIRM_FLAG,
       t.AFFIRMORIDEA,
       to_char(t.UPDATE_DATE, 'YYYY-MM-DD HH24:MI') as UPDATE_DATE
  from GA_SEAL_AFFIRM T,HR_EMPLOYEE HR,
       (select max(affirm.affirm_level) MAX_AFFIRM_LEVEL
          from GA_SEAL_AFFIRM affirm
         WHERE affirm.apply_no = #applyId:VARCHAR#) MAX_AFFIRM_TABLE
 where t.apply_no = #applyId:VARCHAR# AND HR.PERSON_ID=T.AFFIRMOR_ID
 order by t.affirm_level
  ]]>
</select>
<select id="allVisaApproval" parameterClass="SimpleMap" resultClass="SimpleMap">
  <![CDATA[	
	select t.ga_affirm_no,
       t.affirm_flag,
       t.apply_no,
       t.affirm_level,
       t.affirmor_id,
       hr.chinesename,
       CASE WHEN 
       T.AFFIRM_LEVEL=MAX_AFFIRM_TABLE.MAX_AFFIRM_LEVEL
       THEN 1
       ELSE 0
       END MAX_AFFIRM_FLAG,
       t.AFFIRMORIDEA,
       to_char(t.UPDATE_DATE, 'YYYY-MM-DD HH24:MI') as UPDATE_DATE
  from GA_VISA_AFFIRM T,HR_EMPLOYEE HR,
       (select max(affirm.affirm_level) MAX_AFFIRM_LEVEL
          from GA_VISA_AFFIRM affirm
         WHERE affirm.apply_no = #applyId:VARCHAR#) MAX_AFFIRM_TABLE
 where t.apply_no = #applyId:VARCHAR# AND HR.PERSON_ID=T.AFFIRMOR_ID
 order by t.affirm_level
  ]]>
</select>
<select id="excelSealInfoList" parameterClass="SimpleMap" resultClass="SimpleMap">
  <![CDATA[	
	select seal.documentno,
       e.chinesename,
       seal.APPLYORID,
       hr1.chinesename as CONFIRORANDSENDORNAME,
       t.deptname as APPLYDEPTNAME,
       to_char(seal.usedate, 'YYYY-MM-DD') as USEDATE,
       get_code_name(seal.USESEALTYPE) as USESEALTYPE,
       seal.SELECTDEPTID as SELECTDEPTID,
 	   CASE WHEN seal.islend=1
       THEN '是'  ELSE '否'
       END ISLEND,
       USEINFORMATION,
       USESHARES,
       DRAFT_NO,
       NOTE,
       seal.ISCONFIRM,
       seal.FILENAME,
       seal.FILEPATH,
       to_char(seal.returndate, 'YYYY-MM-DD') as RETURNDATE
  from GA_SEAL_APPLY seal, hr_department t, hr_employee e,HR_EMPLOYEE HR1
 where seal.applyordeptid = t.deptid and HR1.PERSON_ID(+)=seal.CONFIRMORID
   and seal.applyorid = e.person_id
   and seal.documentno in (select distinct  a.apply_no from GA_SEAL_AFFIRM a where a.activity =1)
  ]]>
   <isNotEmpty prepend="AND" property="ADMIN_ID">
		<![CDATA[
			EXISTS ( SELECT SAD.ADMIN_DEPTID
				   FROM SY_ADMIN_DEPTID SAD, SY_ADMIN SA
				  WHERE SAD.ADMIN_NO = SA.ADMINNO
				    AND SA.ADMINID = #ADMIN_ID:VARCHAR2#
				    AND SAD.ADMIN_DEPTID = seal.APPLYORDEPTID	
			   ) 
		]]>
	</isNotEmpty>
	<isNotEmpty prepend="AND" property="adminId">
			<![CDATA[		
			   seal.APPLYORID = #adminId:VARCHAR2#
		]]>
		</isNotEmpty>
  <isEqual prepend="AND" property="qryType" compareValue="0"> <!-- 未决裁过的 -->
	<![CDATA[
				 seal.ISCONFIRM=0
	]]>
	</isEqual>
	<isEqual prepend="AND" property="qryType" compareValue="1"> <!-- 决裁通过的 -->
	<![CDATA[
				 seal.ISCONFIRM =1
	]]>
	</isEqual>
	<isNotEmpty prepend="AND" property="key">
		<![CDATA[		   
		 (e.empid LIKE  '%'||#key:VARCHAR# || '%' or e.chinesename LIKE  '%'||#key:VARCHAR# || '%')
		]]>	
	</isNotEmpty>
	<isNotEmpty prepend="AND" property="key2">
		<![CDATA[		   
		 (seal.SELECTDEPTID LIKE  '%'||#key2:VARCHAR# || '%' )
		]]>	
	</isNotEmpty>	
	<isNotEmpty prepend="AND" property="key3">
		<![CDATA[		   
		 (seal.USEINFORMATION LIKE  '%'||#key3:VARCHAR# || '%' )
		]]>	
	</isNotEmpty>
	<isNotEmpty prepend="AND" property="qryType2">
		<isNotEqual prepend="AND" property="qryType2" compareValue="SealType_Code00"> <!-- 请点击下拉条准确选择印章类型 -->
		<![CDATA[
					 (seal.USESEALTYPE LIKE  '%'||#qryType2:VARCHAR# || '%'  )
		]]>
		</isNotEqual>	
	</isNotEmpty>
	<isNotEmpty prepend="AND" property="qryType3">
		<![CDATA[		   
		 (seal.ISLEND =  #qryType3:VARCHAR# )
		]]>	
	</isNotEmpty>			
	<isNotEmpty prepend="AND" property="deptid">
		<![CDATA[		   
		 seal.APPLYORDEPTID=#deptid:VARCHAR#
		]]>	
	</isNotEmpty>	
	<isNotEmpty prepend="AND" property="cpnyId">
		<![CDATA[		   
		 t.CPNY_ID=#cpnyId:VARCHAR#
		]]>	
	</isNotEmpty>
	<isNotEmpty prepend="AND" property="startDate">
		<![CDATA[		   
		 seal.USEDATE >= to_date(#startDate:VARCHAR#,'YYYY-MM-DD')
		]]>	
	</isNotEmpty>	
	<isNotEmpty prepend="AND" property="endDate">
		<![CDATA[		   
		 seal.USEDATE <=to_date(#endDate:VARCHAR#,'YYYY-MM-DD')
		]]>	
	</isNotEmpty>	
	
	<![CDATA[
 order by seal.documentno desc
  ]]>  
	
</select>
<select id="excelVisaInfoList" parameterClass="SimpleMap" resultClass="SimpleMap">
  <![CDATA[	
	select seal.documentno,
       e.chinesename,
       seal.APPLYORID,
       hr1.chinesename as CONFIRORANDSENDORNAME,
       t.deptname as APPLYDEPTNAME,
       to_char(seal.useFdate, 'YYYY-MM-DD') as USEFDATE,
       ceil(USEFDATE-RETURNDATE) as USETDATE,
       CASE WHEN seal.USEVISATYPE=1
       THEN '多次'  ELSE '单次'
       END USEVISATYPE,
       seal.SELECTDEPTID as SELECTDEPTID,
 	   CASE WHEN seal.islend=1
       THEN '加急（2个工作日）'  ELSE '普通（10个工作日）'
       END ISLEND,
       USEINFORMATION,
       USESHARES,
       DRAFT_NO,
       NOTE,
       seal.ISCONFIRM,
       seal.FILENAME,
       seal.FILEPATH,
        seal.MANYZH,
        seal.MANYFW,
         seal.MANYNQ,
         CASE WHEN seal.ISCOMPLISE=1
       THEN '已完成'  WHEN seal.ISCOMPLISE=2 THEN '拒签' ELSE '未完成'
       END ISCOMPLISE,
       to_char(seal.returndate, 'YYYY-MM-DD') as RETURNDATE
  from GA_VISA_APPLY seal, hr_department t, hr_employee e,HR_EMPLOYEE HR1
 where seal.applyordeptid = t.deptid and HR1.PERSON_ID(+)=seal.CONFIRMORID
   and seal.applyorid = e.person_id
   and seal.documentno in (select distinct  a.apply_no from GA_VISA_AFFIRM a where a.activity =1)
  ]]>
   <isNotEmpty prepend="AND" property="ADMIN_ID">
		<![CDATA[
			EXISTS ( SELECT SAD.ADMIN_DEPTID
				   FROM SY_ADMIN_DEPTID SAD, SY_ADMIN SA
				  WHERE SAD.ADMIN_NO = SA.ADMINNO
				    AND SA.ADMINID = #ADMIN_ID:VARCHAR2#
				    AND SAD.ADMIN_DEPTID = seal.APPLYORDEPTID	
			   ) 
		]]>
	</isNotEmpty>
	<isNotEmpty prepend="AND" property="adminId">
			<![CDATA[		
			   seal.APPLYORID = #adminId:VARCHAR2#
		]]>
		</isNotEmpty>
  <isEqual prepend="AND" property="qryType" compareValue="0"> <!-- 未决裁过的 -->
	<![CDATA[
				 seal.ISCOMPLISE=0
	]]>
	</isEqual>
	<isEqual prepend="AND" property="qryType" compareValue="1"> <!-- 决裁通过的 -->
	<![CDATA[
				 seal.ISCOMPLISE =1
	]]>
	</isEqual>
	<isEqual prepend="AND" property="qryType" compareValue="2"> <!-- 决裁通过的 -->
	<![CDATA[
				 seal.ISCOMPLISE =2
	]]>
	</isEqual>
	<isNotEmpty prepend="AND" property="key">
		<![CDATA[		   
		 (e.empid LIKE  '%'||#key:VARCHAR# || '%' or e.chinesename LIKE  '%'||#key:VARCHAR# || '%')
		]]>	
	</isNotEmpty>
	<isNotEmpty prepend="AND" property="key2">
		<![CDATA[		   
		 (seal.SELECTDEPTID LIKE  '%'||#key2:VARCHAR# || '%' )
		]]>	
	</isNotEmpty>	
	<isNotEmpty prepend="AND" property="key3">
		<![CDATA[		   
		 (seal.USEINFORMATION LIKE  '%'||#key3:VARCHAR# || '%' )
		]]>	
	</isNotEmpty>
	<isNotEmpty prepend="AND" property="qryType2">
		<![CDATA[		   
		 (get_code_name(seal.USEVISATYPE) LIKE  '%'||#qryType2:VARCHAR# || '%'  )
		]]>	
	</isNotEmpty>
	<isNotEmpty prepend="AND" property="qryType3">
		<![CDATA[		   
		 (seal.ISLEND =  #qryType3:VARCHAR# )
		]]>	
	</isNotEmpty>			
	<isNotEmpty prepend="AND" property="deptid">
		<![CDATA[		   
		 seal.APPLYORDEPTID=#deptid:VARCHAR#
		]]>	
	</isNotEmpty>	
	<isNotEmpty prepend="AND" property="cpnyId">
		<![CDATA[		   
		 t.CPNY_ID=#cpnyId:VARCHAR#
		]]>	
	</isNotEmpty>
	<isNotEmpty prepend="AND" property="startDate">
		<![CDATA[		   
		 seal.USEFDATE >= to_date(#startDate:VARCHAR#,'YYYY-MM-DD')
		]]>	
	</isNotEmpty>	
	<isNotEmpty prepend="AND" property="endDate">
		<![CDATA[		   
		 seal.USEFDATE <=to_date(#endDate:VARCHAR#,'YYYY-MM-DD')
		]]>	
	</isNotEmpty>	
	
	<![CDATA[
 order by seal.documentno desc
  ]]>  
	
</select>
<select id="excelVisaInfoListALL" parameterClass="SimpleMap" resultClass="SimpleMap">
  <![CDATA[	
	select seal.documentno,
       e.chinesename,
       seal.APPLYORID,
       hr1.chinesename as CONFIRORANDSENDORNAME,
       t.deptname as APPLYDEPTNAME,
       to_char(seal.useFdate, 'YYYY-MM-DD') as USEFDATE,
       to_char(seal.useTdate, 'YYYY-MM-DD') as USETDATE,
       CASE WHEN seal.USEVISATYPE=1
       THEN '多次'  ELSE '单次'
       END USEVISATYPE,
       seal.SELECTDEPTID as SELECTDEPTID,
 	   CASE WHEN seal.islend=1
       THEN '加急（2个工作日）'  ELSE '普通（10个工作日）'
       END ISLEND,
       USEINFORMATION,
       USESHARES,
       DRAFT_NO,
       NOTE,
       seal.ISCONFIRM,
       seal.FILENAME,
       seal.FILEPATH,
        seal.MANYZH,
        seal.MANYFW,
         seal.MANYNQ,
         CASE WHEN seal.ISCOMPLISE=1
       THEN '已完成' WHEN seal.ISCOMPLISE=2 THEN '拒签' ELSE '未完成'
       END ISCOMPLISE,
       to_char(seal.returndate, 'YYYY-MM-DD') as RETURNDATE
  from GA_VISA_APPLY seal, hr_department t, hr_employee e,HR_EMPLOYEE HR1
 where seal.applyordeptid = t.deptid and HR1.PERSON_ID(+)=seal.CONFIRMORID
   and seal.applyorid = e.person_id
   and seal.documentno in (select distinct  a.apply_no from GA_VISA_AFFIRM a where a.activity =1)
  ]]>
	<isNotEmpty prepend="AND" property="adminId">
			<![CDATA[		
			   seal.APPLYORID = #adminId:VARCHAR2#
		]]>
		</isNotEmpty>
   <isEqual prepend="AND" property="qryType" compareValue="0"> <!-- 未决裁过的 -->
	<![CDATA[
				 seal.ISCOMPLISE=0
	]]>
	</isEqual>
	<isEqual prepend="AND" property="qryType" compareValue="1"> <!-- 决裁通过的 -->
	<![CDATA[
				 seal.ISCOMPLISE =1
	]]>
	</isEqual>
	<isEqual prepend="AND" property="qryType" compareValue="2"> <!-- 决裁通过的 -->
	<![CDATA[
				 seal.ISCOMPLISE =2
	]]>
	</isEqual>
	<isNotEmpty prepend="AND" property="key">
		<![CDATA[		   
		 (e.empid LIKE  '%'||#key:VARCHAR# || '%' or e.chinesename LIKE  '%'||#key:VARCHAR# || '%')
		]]>	
	</isNotEmpty>
	<isNotEmpty prepend="AND" property="key2">
		<![CDATA[		   
		 (seal.SELECTDEPTID LIKE  '%'||#key2:VARCHAR# || '%' )
		]]>	
	</isNotEmpty>	
	<isNotEmpty prepend="AND" property="key3">
		<![CDATA[		   
		 (seal.USEINFORMATION LIKE  '%'||#key3:VARCHAR# || '%' )
		]]>	
	</isNotEmpty>
	<isNotEmpty prepend="AND" property="qryType2">
		<![CDATA[		   
		 (get_code_name(seal.USEVISATYPE) LIKE  '%'||#qryType2:VARCHAR# || '%'  )
		]]>	
	</isNotEmpty>
	<isNotEmpty prepend="AND" property="qryType3">
		<![CDATA[		   
		 (seal.ISLEND =  #qryType3:VARCHAR# )
		]]>	
	</isNotEmpty>			
	<isNotEmpty prepend="AND" property="deptid">
		<![CDATA[		   
		 seal.APPLYORDEPTID=#deptid:VARCHAR#
		]]>	
	</isNotEmpty>	
	<isNotEmpty prepend="AND" property="cpnyId">
		<![CDATA[		   
		 t.CPNY_ID=#cpnyId:VARCHAR#
		]]>	
	</isNotEmpty>
	<isNotEmpty prepend="AND" property="startDate">
		<![CDATA[		   
		 seal.USEFDATE >= to_date(#startDate:VARCHAR#,'YYYY-MM-DD')
		]]>	
	</isNotEmpty>	
	<isNotEmpty prepend="AND" property="endDate">
		<![CDATA[		   
		 seal.USEFDATE <=to_date(#endDate:VARCHAR#,'YYYY-MM-DD')
		]]>	
	</isNotEmpty>	
	
	<![CDATA[
 order by seal.documentno desc
  ]]>  
	
</select>
<select id="SealAffirmorList" parameterClass="SimpleMap" resultClass="SimpleMap">
  <![CDATA[	
select t.ga_affirm_no,
       t.affirm_flag,
       t.apply_no,
       t.affirm_level,
       t.affirmor_id,
       hr.chinesename,
       CASE WHEN 
       T.AFFIRM_LEVEL=MAX_AFFIRM_TABLE.MAX_AFFIRM_LEVEL
       THEN 1
       ELSE 0
       END MAX_AFFIRM_FLAG,
       t.AFFIRMORIDEA,
       to_char(t.UPDATE_DATE, 'YYYY-MM-DD HH24:MI') as UPDATE_DATE
  from GA_SEAL_AFFIRM T,HR_EMPLOYEE HR,
       (select max(affirm.affirm_level) MAX_AFFIRM_LEVEL
          from GA_SEAL_AFFIRM affirm
         WHERE affirm.apply_no = #applyId:VARCHAR#) MAX_AFFIRM_TABLE
 where t.apply_no = #applyId:VARCHAR# AND HR.PERSON_ID=T.AFFIRMOR_ID
 order by t.affirm_level
    ]]>
</select>
<select id="VisaAffirmorList" parameterClass="SimpleMap" resultClass="SimpleMap">
  <![CDATA[	
select t.ga_affirm_no,
       t.affirm_flag,
       t.apply_no,
       t.affirm_level,
       t.affirmor_id,
       hr.chinesename,
       CASE WHEN 
       T.AFFIRM_LEVEL=MAX_AFFIRM_TABLE.MAX_AFFIRM_LEVEL
       THEN 1
       ELSE 0
       END MAX_AFFIRM_FLAG,
       t.AFFIRMORIDEA,
       to_char(t.UPDATE_DATE, 'YYYY-MM-DD HH24:MI') as UPDATE_DATE
  from GA_VISA_AFFIRM T,HR_EMPLOYEE HR,
       (select max(affirm.affirm_level) MAX_AFFIRM_LEVEL
          from GA_VISA_AFFIRM affirm
         WHERE affirm.apply_no = #applyId:VARCHAR#) MAX_AFFIRM_TABLE
 where t.apply_no = #applyId:VARCHAR# AND HR.PERSON_ID=T.AFFIRMOR_ID
 order by t.affirm_level
    ]]>
</select>
<delete id="deleteAffim" parameterClass="SimpleMap">
<![CDATA[	
delete GA_SEAL_AFFIRM where APPLY_NO=#applyno:VARCHAR#
]]>
</delete>
<delete id="deleteApply" parameterClass="SimpleMap">
<![CDATA[	
delete GA_SEAL_APPLY where DOCUMENTNO=#applyno:VARCHAR#
]]>
</delete>
<delete id="deleteAffims" parameterClass="SimpleMap">
<![CDATA[	
delete GA_VISA_AFFIRM where APPLY_NO=#applyno:VARCHAR#
]]>
</delete>
<delete id="deleteApplys" parameterClass="SimpleMap">
<![CDATA[	
delete GA_VISA_APPLY where DOCUMENTNO=#applyno:VARCHAR#
]]>
</delete>
<select id="getconfirm" parameterClass="SimpleMap" resultClass="string">
<![CDATA[	
select e.email from hr_employee e where e.person_id=#applerId:varchar#
]]>
</select>

<select id="getsealName" parameterClass="SimpleMap" resultClass="string">
<![CDATA[	
select c.code_name from sy_code c where c.code_id=#sealType:varchar#
]]>
</select>

<select id="getAffirmorIdFirst" parameterClass="SimpleMap" resultClass="string">
<![CDATA[	
select b.affirmor_id from ga_seal_apply a,ga_seal_affirm b where a.documentno = b.apply_no and a.documentno=#documentno:varchar# and b.affirm_level='1'
]]>
</select>
<select id="getAffirmorIdFirstV" parameterClass="SimpleMap" resultClass="string">
<![CDATA[	
select b.affirmor_id from ga_visa_apply a,ga_visa_affirm b where a.documentno = b.apply_no and a.documentno=#documentno:varchar# and b.affirm_level='1'
]]>
</select>
<select id="getApplerId" parameterClass="SimpleMap" resultClass="string">
<![CDATA[	
select b.affirmor_id from ga_seal_apply a,ga_seal_affirm b where a.documentno = b.apply_no and a.documentno=#applyno:varchar# and b.affirm_level=#affrimlevel:numeric#+1
]]>
</select>

<select id="getApplerIds" parameterClass="SimpleMap" resultClass="string">
<![CDATA[	
select b.affirmor_id from ga_visa_apply a,ga_visa_affirm b where a.documentno = b.apply_no and a.documentno=#applyno:varchar# and b.affirm_level=#affrimlevel:numeric#+1
]]>
</select>

<select id="allsealAffrimInfoList1" parameterClass="SimpleMap" resultClass="SimpleMap">
<![CDATA[	
select t.applyordeptid, to_char(t.APPLYDATE, 'YYYY-MM-DD') as APPLYDATE, e.chinesename,c.code_name,
t.SELECTDEPTID,t.useinformation,t.useshares,t.note,t.DRAFT_NO
 from GA_SEAL_APPLY t, hr_employee e,sy_code c where t.documentno = #applyno:VARCHAR# and e.person_id=t.APPLYORID
 and c.code_id = t.usesealtype
 
]]>
</select>

<select id="checkReadCount" parameterClass="SimpleMap"  resultClass="int">
    <![CDATA[
     select count(*)
		  from GA_SEAL_AFFIRM t
		 where t.apply_no = #applyno:VARCHAR2#
		   and t.affirmor_id = #ADMINID:VARCHAR2#
		   and t.read_flag = 0  
    ]]>

</select>

</sqlMap>