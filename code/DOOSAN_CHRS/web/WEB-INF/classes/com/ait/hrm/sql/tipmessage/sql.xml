<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN" "http://www.ibatis.com/dtd/sql-map-2.dtd">

<sqlMap namespace="hrm.tip">

	<select id="getPersonalInfoApplyCount" parameterClass="string"
		resultClass="int">
		<![CDATA[ 
         select count(*) from ess_personal_info where ACTIVITY='0' and EMPID=#empid#
       ]]>
	</select>

	<select id="getPersonalApplyOtCount" parameterClass="SimpleMap"
		resultClass="int">
		<![CDATA[ 
        select count(*) from ESS_APPLY_OT,HR_EMPLOYEE   where HR_EMPLOYEE.PERSON_ID(+)=ESS_APPLY_OT.EMPID and ESS_APPLY_OT.ACTIVITY='0'
        AND (EXISTS (  SELECT * 
	 		             FROM AR_SUPERVISOR_INFO 
	 		            WHERE SUPERVISED_DEPTID = HR_EMPLOYEE.DEPTID
	 		  			  AND AR_SUPERVISOR_ID = #supervisor:VARCHAR#
		 		  	 )
	 					  OR HR_EMPLOYEE.Person_Id= #supervisor:VARCHAR# 
	 	 	 )   
	 	AND ESS_APPLY_OT.APPLY_OT_DATE BETWEEN
               TO_DATE(#starteDate:VARCHAR#, 'YYYY-MM-DD') AND
               TO_DATE(#endDate:VARCHAR#|| ' 23:59:59', 'YYYY-MM-DD HH24:MI:SS')
       ]]>
	</select>

	<select id="getPersonalApplyErvectionCount" parameterClass="string"
		resultClass="int">
		<![CDATA[ 
        select count(*) from ESS_LEAVE_APPLY_TB   
           where leave_empid=#empid# and ACTIVITY='0'
           and leave_type in (
            SELECT CODE_ID
			FROM SY_CODE 
	  	   WHERE PARENT_CODE = 'EvectionTypeCode'   
		   AND ACTIVITY = '1' )
       ]]>
	</select>
	<select id="getPersonalApplyTrainningCount" parameterClass="string"
		resultClass="int">
		<![CDATA[ 
             
       select count(*) from ESS_LEAVE_APPLY_TB   
           where leave_empid=#empid# and ACTIVITY='0'
           and leave_type in (
            SELECT CODE_ID
			FROM SY_CODE 
	  	   WHERE PARENT_CODE = 'TrainingTypeCode'
		   AND ACTIVITY = '1' )
       ]]>
	</select>
	<select id="getPersonalApplyLeavelCount" parameterClass="string"
		resultClass="int">
		<![CDATA[ 
             
		       select count(*) from ESS_LEAVE_APPLY_TB, HR_EMP_V HR_EMPLOYEE  , ESS_AFFIRM
		           where ESS_LEAVE_APPLY_TB.ACTIVITY='0'
		            AND ESS_LEAVE_APPLY_TB.LEAVE_EMPID = HR_EMPLOYEE.Person_Id
		            AND ESS_LEAVE_APPLY_TB.LEAVE_NO = ESS_AFFIRM.APPLY_NO(+)
					AND ESS_AFFIRM.AFFIRM_LEVEL(+) = 1
					AND ESS_AFFIRM.APPLY_TYPE = 'LeaveApply'
		            AND ESS_LEAVE_APPLY_TB.leave_type in (
		            SELECT CODE_ID
		      FROM SY_CODE 
		         WHERE PARENT_CODE = 'LeaveTypeCode'
		       AND SY_CODE.ACTIVITY = '1' )      
	           AND (EXISTS ( SELECT * 
		                       FROM AR_SUPERVISOR_INFO 
		                      WHERE SUPERVISED_DEPTID = HR_EMPLOYEE.DEPTID
		                        AND AR_SUPERVISOR_ID = #empid#
		                   )
	               		  OR HR_EMPLOYEE.Person_Id= #empid# 
	               )   
        ]]>

	</select>


	<select id="getLogOnTipMessage" parameterClass="string"
		resultClass="string">
		<![CDATA[ 
          select max(t.affirm_level) maxlevel from ess_affirm t where t.affirmor_id = #adminid#
       ]]>
	</select>
	
	<select id="getLogOnTipMessageAr" parameterClass="string"
		resultClass="string">
		<![CDATA[ 
          select max(t.affirm_level) maxlevel from AR_DETAIL_AFFIRM t where t.affirmor_id = #adminid#
       ]]>
	</select>

	<select id="getCountOt" parameterClass="SimpleMap" resultClass="int">
		<![CDATA[
             select count(*)from 
             (select * from ess_affirm t 
			        where  t.affirm_flag = 0 
			            and ((t.apply_no in 
			            (select tt.apply_no 
			                  from ess_affirm tt 
			                 where tt.apply_no = t.apply_no 
			                   and tt.affirmor_id <> t.affirmor_id 
			                   and tt.affirm_flag = 1 
			                   and tt.affirm_level = t.affirm_level - 1
			                   and tt.APPLY_TYPE = 'OtApply')
			          ]]>
		<isNotEmpty prepend="AND" property="maxLevel">
	    <![CDATA[
	      t.affirm_level <= #maxLevel#
	      ]]>
		</isNotEmpty>      
		<![CDATA[           
                        )or t.affirm_level = '1') 
			                   and t.apply_type = 'OtApply'
		         ]]>

		<isNotEmpty prepend="AND" property="adminid">
			t.affirmor_id =
			#adminid# 
		</isNotEmpty>
		<![CDATA[ 
		  )
		]]>
	</select>

	<select id="getCountLeave" parameterClass="SimpleMap"
		resultClass="int">
	<![CDATA[
        select count(*)from 
         (select * from ess_affirm t 
			        where  t.affirm_flag = 0 
			            and ((t.apply_no in 
			            (select tt.apply_no 
			                  from ess_affirm tt 
			                 where tt.apply_no = t.apply_no 
			                   and tt.affirmor_id <> t.affirmor_id 
			                   and tt.affirm_flag = 1 
			                   and tt.affirm_level = t.affirm_level - 1
			                   and tt.APPLY_TYPE = 'LeaveApply') 
			          ]]>
		<isNotEmpty prepend="AND" property="maxLevel">
	    <![CDATA[
	      t.affirm_level <= #maxLevel#
	      ]]>
		</isNotEmpty>        
		<![CDATA[         
                        ) or t.affirm_level = '1') 
			                   and t.apply_type = 'LeaveApply'
		         ]]>

		<isNotEmpty prepend="AND" property="adminid">
			t.affirmor_id =
			#adminid#
		</isNotEmpty>
		<![CDATA[ 
		  )
		]]>
	</select>

	<select id="getArmodifyaffirmNo" parameterClass="SimpleMap"
		resultClass="int">
	<![CDATA[
				    
					SELECT COUNT(AR_DETAIL_BACK.EMPID)
				  FROM AR_DETAIL_BACK,
				       AR_DETAIL, 
				       AR_SHIFT010,
				       AR_ITEM,
				       AR_ITEM  AR_ITEM1,
				       HR_EMP_V HR_EMPLOYEE,
				       SY_CODE,
				       SY_CODE SY_CODE1,
				       HR_EMPLOYEE H,
				       (SELECT AR_DETAIL_AFFIRM.*,
				               UP_AFFIRM.AFFIRM_FLAG AS UP_AFFIRM_FLAG,
				               UP_AFFIRM.AFFIRMOR_ID AS UP_AFFIRMOR_ID,
				               NEXT_AFFIRM.AFFIRM_FLAG AS NEXT_AFFIRM_FLAG,
				               (CASE
				                 WHEN AR_DETAIL_AFFIRM.AFFIRM_LEVEL = ESS_AFFIRM_MAX_LEVEL.MAXLEVEL THEN
				                  1
				                 ELSE
				                  0
				               END) MAX_LEVEL_FLAG
				          FROM (SELECT AR_DETAIL_AFFIRM.*,
				                       AR_DETAIL_AFFIRM.AFFIRM_LEVEL - 1 AS UP_LEVEL,
				                       AR_DETAIL_AFFIRM.AFFIRM_LEVEL + 1 AS NEXT_LEVEL
				                  FROM AR_DETAIL_AFFIRM
				                ) AR_DETAIL_AFFIRM,
				               (SELECT T.AR_DETAIL_NO,  MAX(T.AFFIRM_LEVEL) MAXLEVEL
				                  FROM AR_DETAIL_AFFIRM T
				                 GROUP BY T.AR_DETAIL_NO) ESS_AFFIRM_MAX_LEVEL,
				               (SELECT T.AR_DETAIL_NO,
				                       T.AFFIRM_LEVEL,
				                       T.AFFIRMOR_ID,
				                       T.AFFIRM_FLAG
				                  FROM AR_DETAIL_AFFIRM T
				                 ) UP_AFFIRM,
				               (SELECT A.AR_DETAIL_NO,
				                       MAX(A.AFFIRM_FLAG) AS AFFIRM_FLAG
				                  FROM AR_DETAIL_AFFIRM A,
				                       (SELECT T.AR_DETAIL_NO, T.AFFIRMOR_ID, T.AFFIRM_LEVEL
				                          FROM AR_DETAIL_AFFIRM T
				                         WHERE T.AFFIRMOR_ID = #adminid:VARCHAR#
				                        ) B
				                 WHERE 
				                      A.AR_DETAIL_NO = B.AR_DETAIL_NO
				                   AND A.AFFIRM_LEVEL > B.AFFIRM_LEVEL
				                 GROUP BY A.AR_DETAIL_NO) NEXT_AFFIRM
				         WHERE 
				            AR_DETAIL_AFFIRM.AR_DETAIL_NO = UP_AFFIRM.AR_DETAIL_NO(+)
				           AND AR_DETAIL_AFFIRM.UP_LEVEL = UP_AFFIRM.AFFIRM_LEVEL(+)
				           AND AR_DETAIL_AFFIRM.AR_DETAIL_NO = NEXT_AFFIRM.AR_DETAIL_NO(+)
				           AND AR_DETAIL_AFFIRM.AR_DETAIL_NO = ESS_AFFIRM_MAX_LEVEL.AR_DETAIL_NO(+)
				           ) AR_DETAIL_AFFIRM,
				      
				         (SELECT AR_DETAIL_AFFIRM.AFFIRM_FLAG, AR_DETAIL_AFFIRM.AR_DETAIL_NO
				          FROM AR_DETAIL_AFFIRM,
				               (SELECT MAX(AR_DETAIL_AFFIRM.AFFIRM_LEVEL),
				                       MAX(AR_DETAIL_AFFIRM.AR_DETAIL_AFFIRM_NO) AR_DETAIL_AFFIRM_NO
				                  FROM AR_DETAIL_AFFIRM
				                 GROUP BY AR_DETAIL_AFFIRM.AR_DETAIL_NO) HH
				         WHERE AR_DETAIL_AFFIRM.AR_DETAIL_AFFIRM_NO = HH.AR_DETAIL_AFFIRM_NO) MAX_AFFIRMOR_FLAG,
				         (SELECT   A.AR_DATE_STR,
					               A.CPNY_ID,
					               A.LOCK_FLAG_G,
					               A.LOCK_FLAG_Z					               
					          FROM AR_CALENDER A
					         WHERE A.CPNY_ID = #cpnyId:VARCHAR#) AR_CALENDER
				 WHERE 
				   AR_DETAIL_BACK.OPERATION = 'UPDATE' 
				   AND AR_DETAIL_BACK.AR_PK_NO = AR_DETAIL.PK_NO
				   AND AR_DETAIL.SHIFT_NO = AR_SHIFT010.SHIFT_NO(+)   
				   AND AR_DETAIL_BACK.AR_ITEM_NO = AR_ITEM1.ITEM_NO(+)
				   AND AR_DETAIL.AR_ITEM_NO = AR_ITEM.ITEM_NO(+)
				   AND AR_DETAIL_BACK.AR_PK_NO = MAX_AFFIRMOR_FLAG.AR_DETAIL_NO(+)
				   AND AR_DETAIL_BACK.EMPID = HR_EMPLOYEE.person_id
				   AND AR_DETAIL_BACK.AR_PK_NO = AR_DETAIL_AFFIRM.AR_DETAIL_NO
				   AND NVL(AR_DETAIL_AFFIRM.UP_AFFIRM_FLAG, 1) = 1
				   AND AR_DETAIL_AFFIRM.AFFIRMOR_ID = #adminid:VARCHAR#
				   AND AR_DETAIL_BACK.UNIT = SY_CODE.CODE_ID(+)
				   AND AR_DETAIL.UNIT = SY_CODE1.CODE_ID(+)
				   AND AR_DETAIL_BACK.CREATED_BY = H.PERSON_ID(+)
				   AND AR_DETAIL_BACK.AR_DATE_STR = AR_CALENDER.AR_DATE_STR
				   AND DECODE(HR_EMPLOYEE.EMP_DIFF_CODE,'C_12067_1330308',AR_CALENDER.LOCK_FLAG_Z,AR_CALENDER.LOCK_FLAG_G) = 0
				   AND AR_DETAIL_AFFIRM.affirm_flag = 0
		]]>
		
	</select>

	<!-- get vister affirm count -->
	<select id="getVisiterAffirmCnt" parameterClass="SimpleMap"
		resultClass="int">
		<![CDATA[
        
        SELECT COUNT(*)
          FROM GA_VISITER_APPLY_AFFIRM T
         WHERE T.AFFIRM_FLAG = 0
           AND (T.APPLY_NO IN (SELECT TT.APPLY_NO
	                             FROM GA_VISITER_APPLY_AFFIRM TT
	                            WHERE TT.APPLY_NO = T.APPLY_NO
	                              AND TT.AFFIRMOR_ID <> T.AFFIRMOR_ID
	                              AND TT.AFFIRM_FLAG = 1
	                              AND TT.AFFIRM_LEVEL = T.AFFIRM_LEVEL - 1)
                OR T.AFFIRM_LEVEL = '1'
               )
		]]>

		<isNotEmpty prepend="AND" property="adminid">
			T.AFFIRMOR_ID =
			#adminid# 
		</isNotEmpty>

	</select>

	<select id="getEateryAffirmCnt" parameterClass="SimpleMap"
		resultClass="int">
		<![CDATA[
        
        SELECT COUNT(*)
          FROM ga_card_application_affirm T
         WHERE T.AFFIRM_FLAG = 0
           AND (T.APPLY_NO IN (SELECT TT.APPLY_NO
                               FROM ga_card_application_affirm TT
                              WHERE TT.APPLY_NO = T.APPLY_NO
                                AND TT.AFFIRMOR_ID <> T.AFFIRMOR_ID
                                AND TT.AFFIRM_FLAG = 1
                                AND TT.AFFIRM_LEVEL = T.AFFIRM_LEVEL - 1)
                OR T.AFFIRM_LEVEL = '1'
               )
           AND T.AFFIRMOR_ID = #adminid# 
		]]>

	</select>
	<select id="getProductsAffirmCnt" parameterClass="SimpleMap"
		resultClass="int">
		<![CDATA[
        
        SELECT COUNT(*)
          FROM ga_products_affirm T
         WHERE T.AFFIRM_FLAG = 0
           AND (T.APPLY_NO IN (SELECT TT.APPLY_NO
                               FROM ga_products_affirm TT
                              WHERE TT.APPLY_NO = T.APPLY_NO
                                AND TT.AFFIRMOR_ID <> T.AFFIRMOR_ID
                                AND TT.AFFIRM_FLAG = 1
                                AND TT.AFFIRM_LEVEL = T.AFFIRM_LEVEL - 1)
                OR T.AFFIRM_LEVEL = '1'
               )
           AND T.AFFIRMOR_ID = #adminid# 
		]]>

	</select>

	<select id="getSecurityAffirmCnt" parameterClass="SimpleMap"
		resultClass="int">
	<![CDATA[
       
      select count(t.applyno) as applyno
from se_completrectificat_apply   t,
       hr_employee              hr,
       hr_department            de,
       se_securitychecks_record re,
(SELECT se_completrectificat_affirm.*,
               UP_AFFIRM.AFFIRMOR_ID UP_AFFIRMOR_ID,
               NVL(UP_AFFIRM.AFFIRM_FLAG, 1) UP_AFFIRM_FLAG,
               CASE
                 WHEN se_completrectificat_affirm.AFFIRM_LEVEL =
                      MAX_AFFIRM.MAX_LEVEL THEN
                  1
                 ELSE
                  0
               END AS MAX_LEVEL_FLAG
          FROM (SELECT se_completrectificat_affirm.*,
                       se_completrectificat_affirm.AFFIRM_LEVEL - 1 UP_LEVEL,
                       se_completrectificat_affirm.AFFIRM_LEVEL + 1 NEXT_LEVEL
                  FROM se_completrectificat_affirm) se_completrectificat_affirm,
               (SELECT se_completrectificat_affirm.APPLY_NO,
                       se_completrectificat_affirm.AFFIRM_LEVEL,
                       se_completrectificat_affirm.AFFIRMOR_ID,
                       se_completrectificat_affirm.AFFIRM_FLAG
                  FROM se_completrectificat_affirm) UP_AFFIRM,
               (SELECT se_completrectificat_affirm.APPLY_NO,
                       MAX(se_completrectificat_affirm.AFFIRM_LEVEL) MAX_LEVEL
                  FROM se_completrectificat_affirm
                 GROUP BY se_completrectificat_affirm.APPLY_NO) MAX_AFFIRM
         WHERE se_completrectificat_affirm.APPLY_NO = UP_AFFIRM.APPLY_NO(+)
           AND se_completrectificat_affirm.UP_LEVEL = UP_AFFIRM.AFFIRM_LEVEL(+)
           AND se_completrectificat_affirm.APPLY_NO = MAX_AFFIRM.APPLY_NO(+)
           and se_completrectificat_affirm.affirmor_id = #adminid:VARCHAR#) AFFIRM
 where hr.person_id = t.applyorid
   and de.deptid = t.deptid
   and t.applyno = AFFIRM.APPLY_NO
   AND AFFIRM.UP_AFFIRM_FLAG = 1
   and t.securitychecksno = re.documentno
   and t.applyno in ( select distinct t.apply_no from se_completrectificat_affirm t where t.activity=1 and t.affirmor_id=#adminid:VARCHAR#
   and t.affirm_flag=0 )
   AND EXISTS (SELECT SAD.ADMIN_DEPTID
              FROM SY_ADMIN_DEPTID SAD, SY_ADMIN SA
             WHERE SAD.ADMIN_NO = SA.ADMINNO
  	           AND SA.ADMINID = #adminid:VARCHAR#
         AND SAD.ADMIN_DEPTID = hr.deptid)
	]]>
	</select>

	<!-- 设施决裁 -->
	<select id="getFacilityAffirmCnt" parameterClass="SimpleMap"
		resultClass="int">
	<![CDATA[
       
      select count(t.applyno) as applyno
  from se_completrectificat_apply t,
       hr_employee                hr,
       hr_department              de,
       (SELECT se_completrectificat_affirm.*,
               UP_AFFIRM.AFFIRMOR_ID UP_AFFIRMOR_ID,
               NVL(UP_AFFIRM.AFFIRM_FLAG, 1) UP_AFFIRM_FLAG,
               CASE
                 WHEN se_completrectificat_affirm.AFFIRM_LEVEL =
                      MAX_AFFIRM.MAX_LEVEL THEN
                  1
                 ELSE
                  0
               END AS MAX_LEVEL_FLAG
          FROM (SELECT se_completrectificat_affirm.*,
                       se_completrectificat_affirm.AFFIRM_LEVEL - 1 UP_LEVEL,
                       se_completrectificat_affirm.AFFIRM_LEVEL + 1 NEXT_LEVEL
                  FROM se_completrectificat_affirm) se_completrectificat_affirm,
               (SELECT se_completrectificat_affirm.APPLY_NO,
                       se_completrectificat_affirm.AFFIRM_LEVEL,
                       se_completrectificat_affirm.AFFIRMOR_ID,
                       se_completrectificat_affirm.AFFIRM_FLAG
                  FROM se_completrectificat_affirm) UP_AFFIRM,
               (SELECT se_completrectificat_affirm.APPLY_NO,
                       MAX(se_completrectificat_affirm.AFFIRM_LEVEL) MAX_LEVEL
                  FROM se_completrectificat_affirm
                 GROUP BY se_completrectificat_affirm.APPLY_NO) MAX_AFFIRM
         WHERE se_completrectificat_affirm.APPLY_NO = UP_AFFIRM.APPLY_NO(+)
           AND se_completrectificat_affirm.UP_LEVEL =
               UP_AFFIRM.AFFIRM_LEVEL(+)
           AND se_completrectificat_affirm.APPLY_NO = MAX_AFFIRM.APPLY_NO(+)
           and se_completrectificat_affirm.affirmor_id = #adminid:VARCHAR#) AFFIRM
 where hr.person_id = t.applyorid
   and de.deptid = t.deptid
   and t.applyno = AFFIRM.APPLY_NO
   AND AFFIRM.UP_AFFIRM_FLAG = 1
   and t.applyno in ( select distinct t.apply_no from se_completrectificat_affirm t where t.activity=1 and t.affirmor_id=#adminid:VARCHAR#
   and t.affirm_flag=0 )
   AND EXISTS (SELECT SAD.ADMIN_DEPTID
              FROM SY_ADMIN_DEPTID SAD, SY_ADMIN SA
             WHERE SAD.ADMIN_NO = SA.ADMINNO
  	           AND SA.ADMINID = #adminid:VARCHAR#
         AND SAD.ADMIN_DEPTID = hr.deptid)
	]]>
	</select>


	<select id="getForkliAffirmCnt" parameterClass="SimpleMap"
		resultClass="int">
	<![CDATA[
       
      select count(t.applyno) as applyno
  from se_forkliftmaintain_apply t,
       hr_employee                hr,
       hr_department              de,
       (SELECT se_forkliftmaintain_affirm.*,
               UP_AFFIRM.AFFIRMOR_ID UP_AFFIRMOR_ID,
               NVL(UP_AFFIRM.AFFIRM_FLAG, 1) UP_AFFIRM_FLAG,
               CASE
                 WHEN se_forkliftmaintain_affirm.AFFIRM_LEVEL =
                      MAX_AFFIRM.MAX_LEVEL THEN
                  1
                 ELSE
                  0
               END AS MAX_LEVEL_FLAG
          FROM (SELECT se_forkliftmaintain_affirm.*,
                       se_forkliftmaintain_affirm.AFFIRM_LEVEL - 1 UP_LEVEL,
                       se_forkliftmaintain_affirm.AFFIRM_LEVEL + 1 NEXT_LEVEL
                  FROM se_forkliftmaintain_affirm) se_forkliftmaintain_affirm,
               (SELECT se_forkliftmaintain_affirm.APPLY_NO,
                       se_forkliftmaintain_affirm.AFFIRM_LEVEL,
                       se_forkliftmaintain_affirm.AFFIRMOR_ID,
                       se_forkliftmaintain_affirm.AFFIRM_FLAG
                  FROM se_forkliftmaintain_affirm) UP_AFFIRM,
               (SELECT se_forkliftmaintain_affirm.APPLY_NO,
                       MAX(se_forkliftmaintain_affirm.AFFIRM_LEVEL) MAX_LEVEL
                  FROM se_forkliftmaintain_affirm
                 GROUP BY se_forkliftmaintain_affirm.APPLY_NO) MAX_AFFIRM
         WHERE se_forkliftmaintain_affirm.APPLY_NO = UP_AFFIRM.APPLY_NO(+)
           AND se_forkliftmaintain_affirm.UP_LEVEL =
               UP_AFFIRM.AFFIRM_LEVEL(+)
           AND se_forkliftmaintain_affirm.APPLY_NO = MAX_AFFIRM.APPLY_NO(+)
           and se_forkliftmaintain_affirm.affirmor_id = #adminid:VARCHAR#) AFFIRM
 where hr.person_id = t.applyorid
   and de.deptid = t.deptid
   and t.applyno = AFFIRM.APPLY_NO
   AND AFFIRM.UP_AFFIRM_FLAG = 1
   and t.applyno in ( select distinct t.apply_no from se_forkliftmaintain_affirm t where t.activity=1 and t.affirmor_id=#adminid:VARCHAR#
   and t.affirm_flag=0 )
   AND EXISTS (SELECT SAD.ADMIN_DEPTID
              FROM SY_ADMIN_DEPTID SAD, SY_ADMIN SA
             WHERE SAD.ADMIN_NO = SA.ADMINNO
               AND SA.ADMINID = #adminid:VARCHAR#
         AND SAD.ADMIN_DEPTID = hr.deptid)
	]]>
	</select>

	<!-- get visiter confirm count -->
	<select id="getVisiterConfirmCnt" resultClass="int">
		<![CDATA[				
  		  		   SELECT COUNT(*)
				     FROM GA_VISITER_APPLY,hr_employee hr
					WHERE play_apply=hr.person_id
					  AND ACTIVE = 1
					  AND MODIFY_FLAG = 0
					   and EXISTS (SELECT SAD.ADMIN_DEPTID
						          FROM SY_ADMIN_DEPTID SAD, SY_ADMIN SA
						         WHERE SAD.ADMIN_NO = SA.ADMINNO
						           AND SA.ADMINID = #adminId:VARCHAR#
						           AND SAD.ADMIN_DEPTID = HR.DEPTID)
		      
		]]>
	</select>
	<select id="getVisaConfirmCnt" resultClass="int">
			<![CDATA[				
	  		  		   SELECT COUNT(*)
					     FROM GA_VISA_APPLY,hr_employee hr
						WHERE applyORID=hr.person_id
						  AND ISCOMPLISE IS NULL
						   and EXISTS (SELECT SAD.ADMIN_DEPTID
							          FROM SY_ADMIN_DEPTID SAD, SY_ADMIN SA
							         WHERE SAD.ADMIN_NO = SA.ADMINNO
							           AND SA.ADMINID = #adminId:VARCHAR#
							           AND SAD.ADMIN_DEPTID = HR.DEPTID)
			      
			]]>
		</select>
	<!-- get personal apply visiter count -->
	<select id="getVisiterApplyCnt" parameterClass="SimpleMap"
		resultClass="int">
		<![CDATA[
        
       		   SELECT COUNT(*)
			     FROM GA_VISITER_APPLY A
				WHERE A.PLAY_APPLY =#supervisor:varchar#
				  AND ACTIVE < 2
				  AND MODIFY_FLAG = 0
		]]>

	</select>

	<!-- get meetingroom confirm count -->
	<select id="getMeetingroomConfirmCnt" resultClass="int">
		<![CDATA[	
	 			  SELECT COUNT(*)
				    FROM PU_CONFERENCEROOM_APPLY A,PU_ROOM  ROOM
				   WHERE A.ACTIVE = 1
				     AND A.ISCONFIRM = 0
				     AND A.CONFERENCEROOM = ROOM.ID
				     AND (ROOM.CONFIRMORID = #adminId:VARCHAR# OR ROOM.CONFIRMORID IS NULL)
				     and EXISTS (SELECT SAD.ADMIN_DEPTID
						          FROM SY_ADMIN_DEPTID SAD, SY_ADMIN SA
						         WHERE SAD.ADMIN_NO = SA.ADMINNO
						           AND SA.ADMINID = #adminId:VARCHAR#
						           AND SAD.ADMIN_DEPTID = A.applyordeptid)
			]]>
	</select>
	<select id="countEateryConfirmCnt" resultClass="int">
		<![CDATA[	
	 			  select count(*) from ga_card_application t
						where t.active=1
						and t.isconfirm=0
						and EXISTS (SELECT SAD.ADMIN_DEPTID
						          FROM SY_ADMIN_DEPTID SAD, SY_ADMIN SA
						         WHERE SAD.ADMIN_NO = SA.ADMINNO
						           AND SA.ADMINID = #adminId:VARCHAR#
						           AND SAD.ADMIN_DEPTID = t.applyer_dept)
			]]>
	</select>

	<!-- get person apply count -->
	<select id="getMeetingroomApplyCnt" parameterClass="SimpleMap"
		resultClass="int">
		<![CDATA[
        
       		   	   SELECT COUNT(*)
				     FROM PU_CONFERENCEROOM_APPLY A					 	  
					WHERE ACTIVE < 2
					  AND ISCONFIRM = 0
					  AND A.APPLYORID=#supervisor:varchar#
		]]>
	</select>

	<select id="getEateryApplyCnt" parameterClass="SimpleMap"
		resultClass="int">
		<![CDATA[
        
       		   	   select count(*) from ga_card_application t  
									where t.active<2
									and t.isconfirm=0									
									and t.applyer=#supervisor:varchar#
		]]>
	</select>

	<select id="getProductsApplyCnt" parameterClass="SimpleMap"
		resultClass="int">
		<![CDATA[
        
       		   	   select count(*) from ga_products_apply t  
									where t.active<2
									and t.confirm_flag=0									
									and t.wp_applyerid=#adminId:varchar#
		]]>
	</select>

	<!-- get present apply count -->
	<select id="getPresentApplyCnt" parameterClass="SimpleMap"
		resultClass="int">
		<![CDATA[
        
					SELECT COUNT (*) CNT
					  FROM GA_PRESENT_APPLY A
					 WHERE A.ACTIVITY = 1
					   AND A.CREATED_BY = #adminId:varchar#
					   AND A.CONFIRM_FLAG = 0
		]]>
	</select>

	<!-- get festival present apply count -->
	<select id="getFestivalPresentApplyCnt" parameterClass="SimpleMap"
		resultClass="int">
		<![CDATA[
        
					SELECT COUNT (*) CNT
					  FROM GA_FESTIVAL_PRESENT_APPLY A
					 WHERE A.ACTIVITY = 1
					   AND A.CREATED_BY = #adminId:varchar#
					   AND A.CONFIRM_FLAG = 0
		]]>
	</select>

	<!-- get Attendance to modify apply count -->
	<select id="getApplyLeavelModifyCount" parameterClass="SimpleMap"
		resultClass="int">
		<![CDATA[
        
					select count(*) from AR_DETAIL_BACK B where B.flag='0'
					   AND B.CREATED_BY = #adminId:varchar#
		]]>
	</select>

	<!-- get present affirm count -->
	<select id="getPresentAffirmCnt" parameterClass="SimpleMap"
		resultClass="int">
		<![CDATA[
		        SELECT COUNT (*) CNT
				  FROM GA_PRESENT_APPLY A, HR_EMPLOYEE B, HR_EMPLOYEE C
				 WHERE A.CREATED_BY = B.PERSON_ID
				   AND A.UPDATED_BY = C.PERSON_ID(+)
				   AND A.ACTIVITY = 1
				   AND A.SEQ_NO IN (
				          SELECT T.APPLY_NO
				            FROM GA_PRESENT_AFFIRM T
				           WHERE T.AFFIRM_FLAG = 0
				             AND T.AFFIRMOR_ID = #adminid:varchar#
				             AND (   T.APPLY_NO IN (
				                        SELECT TT.APPLY_NO
				                          FROM GA_PRESENT_AFFIRM TT
				                         WHERE TT.APPLY_NO = T.APPLY_NO
				                           AND TT.AFFIRMOR_ID <> T.AFFIRMOR_ID
				                           AND TT.AFFIRM_FLAG = 1
				                           AND TT.AFFIRM_LEVEL = T.AFFIRM_LEVEL - 1)
				                  OR T.AFFIRM_LEVEL = '1'
				                 ))
		]]>
	</select>

	<!-- get check affirm count -->
	<select id="getCheckAffirmCnt" parameterClass="SimpleMap"
		resultClass="int">
		<![CDATA[
                 SELECT COUNT(*)
                   FROM GA_CHECK_APPLY_AFFIRM T
                  WHERE T.AFFIRM_FLAG = 0
                    AND (T.APPLY_NO IN
                        (SELECT TT.APPLY_NO
                            FROM GA_CHECK_APPLY_AFFIRM TT
                           WHERE TT.APPLY_NO = T.APPLY_NO
                             AND TT.AFFIRMOR_ID <> T.AFFIRMOR_ID
                             AND TT.AFFIRM_FLAG = 1
                             AND TT.AFFIRM_LEVEL = T.AFFIRM_LEVEL - 1) OR
                        T.AFFIRM_LEVEL = '1')
                    AND T.AFFIRMOR_ID = #adminid# 
		]]>
	</select>

	<select id="expressAffirmListNumber" parameterClass="SimpleMap"
		resultClass="int">
<![CDATA[	
	 select count(a.apply_no)  from ga_express_apply a ,
	(SELECT 
			 GA_EXPRESS_AFFIRM.*,
			 UP_AFFIRM.AFFIRMOR_ID UP_AFFIRMOR_ID,
			 NVL(UP_AFFIRM.AFFIRM_FLAG,1) UP_AFFIRM_FLAG,
			 CASE 
			 WHEN GA_EXPRESS_AFFIRM.AFFIRM_LEVEL=MAX_AFFIRM.MAX_LEVEL
			 THEN 1
			 ELSE 0
			 END AS MAX_LEVEL_FLAG
			 FROM 
			 (SELECT GA_EXPRESS_AFFIRM.*,
			       GA_EXPRESS_AFFIRM.AFFIRM_LEVEL - 1 UP_LEVEL,
			       GA_EXPRESS_AFFIRM.AFFIRM_LEVEL + 1 NEXT_LEVEL
			  FROM GA_EXPRESS_AFFIRM) GA_EXPRESS_AFFIRM,
			  (SELECT  GA_EXPRESS_AFFIRM.APPLY_NO,GA_EXPRESS_AFFIRM.AFFIRM_LEVEL,GA_EXPRESS_AFFIRM.AFFIRMOR_ID,GA_EXPRESS_AFFIRM.AFFIRM_FLAG
			  FROM GA_EXPRESS_AFFIRM 
			  ) UP_AFFIRM,
			  (SELECT  GA_EXPRESS_AFFIRM.APPLY_NO,MAX(GA_EXPRESS_AFFIRM.AFFIRM_LEVEL) MAX_LEVEL
			  FROM GA_EXPRESS_AFFIRM 
			   GROUP BY GA_EXPRESS_AFFIRM.APPLY_NO ) MAX_AFFIRM
			   WHERE GA_EXPRESS_AFFIRM.APPLY_NO=UP_AFFIRM.APPLY_NO(+)
			    AND GA_EXPRESS_AFFIRM.UP_LEVEL=UP_AFFIRM.AFFIRM_LEVEL(+)    
			    AND GA_EXPRESS_AFFIRM.APPLY_NO=MAX_AFFIRM.APPLY_NO(+)
			    and GA_EXPRESS_AFFIRM.affirmor_id=#applerId:VARCHAR#) AFFIRM
	 where AFFIRM.UP_AFFIRM_FLAG=1 and a.apply_no = AFFIRM.APPLY_NO
	 and a.apply_no in( select distinct t.apply_no from ga_express_affirm t where  t.activity='1'  and  t.affirmor_id=#applerId:VARCHAR#
			and	 t.affirm_flag=0
   )
	]]>
	</select>
	<select id="sealAffirmAndInformationListNumber" parameterClass="SimpleMap"
		resultClass="int">
  <![CDATA[	
    select count(t.documentno) as documentno  
from ga_seal_apply t , hr_employee e,
(SELECT GA_SEAL_AFFIRM.*,
               UP_AFFIRM.AFFIRMOR_ID UP_AFFIRMOR_ID,
               NVL(UP_AFFIRM.AFFIRM_FLAG, 1) UP_AFFIRM_FLAG,
               CASE
                 WHEN GA_SEAL_AFFIRM.AFFIRM_LEVEL =
                      MAX_AFFIRM.MAX_LEVEL THEN
                  1
                 ELSE
                  0
               END AS MAX_LEVEL_FLAG
          FROM (SELECT GA_SEAL_AFFIRM.*,
                       GA_SEAL_AFFIRM.AFFIRM_LEVEL - 1 UP_LEVEL,
                       GA_SEAL_AFFIRM.AFFIRM_LEVEL + 1 NEXT_LEVEL
                  FROM GA_SEAL_AFFIRM) GA_SEAL_AFFIRM,
               (SELECT GA_SEAL_AFFIRM.APPLY_NO,
                       GA_SEAL_AFFIRM.AFFIRM_LEVEL,
                       GA_SEAL_AFFIRM.AFFIRMOR_ID,
                       GA_SEAL_AFFIRM.AFFIRM_FLAG
                  FROM GA_SEAL_AFFIRM) UP_AFFIRM,
               (SELECT GA_SEAL_AFFIRM.APPLY_NO,
                       MAX(GA_SEAL_AFFIRM.AFFIRM_LEVEL) MAX_LEVEL
                  FROM GA_SEAL_AFFIRM
                 GROUP BY GA_SEAL_AFFIRM.APPLY_NO) MAX_AFFIRM
         WHERE GA_SEAL_AFFIRM.APPLY_NO = UP_AFFIRM.APPLY_NO(+)
           AND GA_SEAL_AFFIRM.UP_LEVEL = UP_AFFIRM.AFFIRM_LEVEL(+)
           AND GA_SEAL_AFFIRM.APPLY_NO = MAX_AFFIRM.APPLY_NO(+)
           and GA_SEAL_AFFIRM.affirmor_id = #applerId:VARCHAR#) AFFIRM
where   AFFIRM.UP_AFFIRM_FLAG=1
   and t.DOCUMENTNO=AFFIRM.APPLY_NO and e.person_id=t.applyorid
   and t.DOCUMENTNO in
       (select distinct a.apply_no
          from GA_SEAL_AFFIRM a
         where a.affirmor_id = #applerId:VARCHAR#
			and	 a.affirm_flag=0
   )
   ]]>
	</select>
<select id="visaAffirmAndInformationListNumber" parameterClass="SimpleMap"
		resultClass="int">
  <![CDATA[	
    select count(t.documentno) as documentno  
from ga_visa_apply t , hr_employee e,
(SELECT GA_VISA_AFFIRM.*,
               UP_AFFIRM.AFFIRMOR_ID UP_AFFIRMOR_ID,
               NVL(UP_AFFIRM.AFFIRM_FLAG, 1) UP_AFFIRM_FLAG,
               CASE
                 WHEN GA_VISA_AFFIRM.AFFIRM_LEVEL =
                      MAX_AFFIRM.MAX_LEVEL THEN
                  1
                 ELSE
                  0
               END AS MAX_LEVEL_FLAG
          FROM (SELECT GA_VISA_AFFIRM.*,
                       GA_VISA_AFFIRM.AFFIRM_LEVEL - 1 UP_LEVEL,
                       GA_VISA_AFFIRM.AFFIRM_LEVEL + 1 NEXT_LEVEL
                  FROM GA_VISA_AFFIRM) GA_VISA_AFFIRM,
               (SELECT GA_VISA_AFFIRM.APPLY_NO,
                       GA_VISA_AFFIRM.AFFIRM_LEVEL,
                       GA_VISA_AFFIRM.AFFIRMOR_ID,
                       GA_VISA_AFFIRM.AFFIRM_FLAG
                  FROM GA_VISA_AFFIRM) UP_AFFIRM,
               (SELECT GA_VISA_AFFIRM.APPLY_NO,
                       MAX(GA_VISA_AFFIRM.AFFIRM_LEVEL) MAX_LEVEL
                  FROM GA_VISA_AFFIRM
                 GROUP BY GA_VISA_AFFIRM.APPLY_NO) MAX_AFFIRM
         WHERE GA_VISA_AFFIRM.APPLY_NO = UP_AFFIRM.APPLY_NO(+)
           AND GA_VISA_AFFIRM.UP_LEVEL = UP_AFFIRM.AFFIRM_LEVEL(+)
           AND GA_VISA_AFFIRM.APPLY_NO = MAX_AFFIRM.APPLY_NO(+)
           and GA_VISA_AFFIRM.affirmor_id = #applerId:VARCHAR#) AFFIRM
where   AFFIRM.UP_AFFIRM_FLAG=1
   and t.DOCUMENTNO=AFFIRM.APPLY_NO and e.person_id=t.applyorid
   and t.DOCUMENTNO in
       (select distinct a.apply_no
          from GA_VISA_AFFIRM a
         where a.affirmor_id = #applerId:VARCHAR#
      and   a.affirm_flag=0
   )
   ]]>
	</select>
	<select id="getvoitureInt" parameterClass="SimpleMap"
		resultClass="int">
    <![CDATA[	
			select count(*)
							  from GA_VOITURE_APPLY t,
							  hr_employee e,
			               (SELECT 
			 GA_VOITURE_AFFIRM.*,
			 UP_AFFIRM.AFFIRMOR_ID UP_AFFIRMOR_ID,
			 NVL(UP_AFFIRM.AFFIRM_FLAG,1) UP_AFFIRM_FLAG,
			 CASE 
			 WHEN GA_VOITURE_AFFIRM.AFFIRM_LEVEL=MAX_AFFIRM.MAX_LEVEL
			 THEN 1
			 ELSE 0
			 END AS MAX_LEVEL_FLAG
			 FROM 
			 (SELECT GA_VOITURE_AFFIRM.*,
			       GA_VOITURE_AFFIRM.AFFIRM_LEVEL - 1 UP_LEVEL,
			       GA_VOITURE_AFFIRM.AFFIRM_LEVEL + 1 NEXT_LEVEL
			  FROM GA_VOITURE_AFFIRM) GA_VOITURE_AFFIRM,
			  (SELECT  GA_VOITURE_AFFIRM.APPLY_NO,GA_VOITURE_AFFIRM.AFFIRM_LEVEL,GA_VOITURE_AFFIRM.AFFIRMOR_ID,GA_VOITURE_AFFIRM.AFFIRM_FLAG
			  FROM GA_VOITURE_AFFIRM 
			  ) UP_AFFIRM,
			  (SELECT  GA_VOITURE_AFFIRM.APPLY_NO,MAX(GA_VOITURE_AFFIRM.AFFIRM_LEVEL) MAX_LEVEL
			  FROM GA_VOITURE_AFFIRM 
			   GROUP BY GA_VOITURE_AFFIRM.APPLY_NO ) MAX_AFFIRM
			   WHERE GA_VOITURE_AFFIRM.APPLY_NO=UP_AFFIRM.APPLY_NO(+)
			    AND GA_VOITURE_AFFIRM.UP_LEVEL=UP_AFFIRM.AFFIRM_LEVEL(+)    
			    AND GA_VOITURE_AFFIRM.APPLY_NO=MAX_AFFIRM.APPLY_NO(+)
			    and GA_VOITURE_AFFIRM.affirmor_id=#applerId:VARCHAR#) AFFIRM 
			    where t.voiture_applyid in (select a.APPLY_NO from GA_VOITURE_AFFIRM a where a.AFFIRMOR_ID=#applerId:VARCHAR#)
               AND AFFIRM.UP_AFFIRM_FLAG=1
               and t.applyer_id=e.person_id
				and  AFFIRM.affirm_flag=0
				and t.voiture_applyid = AFFIRM.APPLY_NO
     order by t.voiture_applyid desc
	]]>
	</select>

	<select id="confirmvoitureCnt" parameterClass="SimpleMap"
		resultClass="int">
    <![CDATA[	
    select count(*)
			from GA_VOITURE_APPLY apply,hr_employee e
			where apply.active='1' and apply.apply_enddate>=to_date(to_char(SYSDATE,'yyyy-mm-dd'),'yyyy-mm-dd') and apply.applyer_id=e.person_id
			  and apply.MODIFY_FLAG='0'
	]]>
	</select>

	<!-- get present confirm count -->
	<select id="getPresentConfirmCnt" parameterClass="SimpleMap"
		resultClass="int">
		<![CDATA[
        
		       		   	SELECT COUNT (*) CNT
						  FROM GA_PRESENT_APPLY A,HR_EMPLOYEE HR
						 WHERE A.ACTIVITY = 1
						   AND A.AFFIRM_FLAG = 1
						   AND A.CONFIRM_FLAG =0
						   AND A.CREATED_BY=HR.PERSON_ID(+)
						   AND EXISTS (SELECT SAD.ADMIN_DEPTID
			                      FROM SY_ADMIN_DEPTID SAD, SY_ADMIN SA
			                     WHERE SAD.ADMIN_NO = SA.ADMINNO
			          	           AND SA.ADMINID = #adminId:VARCHAR#
									           AND SAD.ADMIN_DEPTID = hr.deptid)
		]]>
	</select>

	<!-- get festival present confirm count -->
	<select id="getFestivalPresentConfirmCnt" parameterClass="SimpleMap"
		resultClass="int">
		<![CDATA[
        				SELECT COUNT(*) CNT
						  FROM GA_FESTIVAL_PRESENT_APPLY A
						 WHERE A.ACTIVITY = 1
						   AND A.AFFIRM_FLAG = 1
						   AND A.CONFIRM_FLAG = 0
						   AND (SELECT HR.CPNY_ID
						          FROM HR_EMPLOYEE HR
						         WHERE A.CREATED_BY = HR.PERSON_ID) = #cpnyId:VARCHAR#
        				
		]]>
	</select>

	<!-- get wash apply count -->
	<select id="getWashApplyCnt" parameterClass="SimpleMap"
		resultClass="int">
		<![CDATA[
        
					SELECT COUNT (*) CNT
					  FROM GA_WASHHOUSE_APPLY A
					 WHERE A.ACTIVITY = 1
					   AND A.CREATED_BY = #adminId:varchar#
					   AND A.CONFIRM_FLAG = 0
		]]>
	</select>

	<!-- get wash confirm count -->
	<select id="getWashConfirmCnt" parameterClass="SimpleMap"
		resultClass="int">
		<![CDATA[
        
		       		   	SELECT COUNT (*) CNT
						  FROM GA_WASHHOUSE_APPLY A,HR_EMPLOYEE HR
						 WHERE A.ACTIVITY = 1
						   AND A.AFFIRM_FLAG = 1
						   AND A.CONFIRM_FLAG =0
						   AND A.CREATED_BY=HR.PERSON_ID(+)
						   AND EXISTS (SELECT SAD.ADMIN_DEPTID
			                      FROM SY_ADMIN_DEPTID SAD, SY_ADMIN SA
			                     WHERE SAD.ADMIN_NO = SA.ADMINNO
			          	           AND SA.ADMINID = #adminId:VARCHAR#
									           AND SAD.ADMIN_DEPTID = hr.deptid)
		]]>
	</select>

	<!-- get Security confirm count -->
	<select id="getSecurityConfirmCnt" parameterClass="SimpleMap"
		resultClass="int">
		<![CDATA[
        select count(t.documentno)
  from se_securitychecks_record t,sy_code sc1,sy_code sc2, hr_employee hr, hr_department v,se_completrectificat_apply apply
 where t.active = '1'
   and hr.person_id(+) = t.securitychecksor_id
   and t.deptid = v.deptid(+)
   and sc1.code_id(+)= t.hiddendangerscommunications
   and sc2.code_id(+)= t.rectificationrequirements 
   and apply.securitychecksno(+)=t.documentno
   and EXISTS (SELECT SAD.ADMIN_DEPTID
                FROM SY_ADMIN_DEPTID SAD, SY_ADMIN SA
               WHERE SAD.ADMIN_NO = SA.ADMINNO
    	           AND SA.ADMINID = #adminId:VARCHAR#
           AND SAD.ADMIN_DEPTID = hr.deptid) and t.ISRECTIFICATION = 3
		]]>
	</select>

	<select id="getSecurityApplyCnt" parameterClass="SimpleMap"
		resultClass="int">
		<![CDATA[
select count(t.applyno) as applyno
from se_completrectificat_apply   t
 where t.applyorid=#adminId:VARCHAR#
 and t.active=0

		]]>
	</select>

	<!-- get getProductsConfirmCnt  count -->
	<select id="getProductsConfirmCnt" parameterClass="SimpleMap"
		resultClass="int" remapResults="true">
		<![CDATA[
        
      	select count(*)
		     from ga_products_apply t, hr_employee hr
			 where t.wp_applyerid = hr.person_id(+)
			 and t.active=1
			 and t.confirm_flag=0
			 and EXISTS (SELECT SAD.ADMIN_DEPTID
			                      FROM SY_ADMIN_DEPTID SAD, SY_ADMIN SA
			                     WHERE SAD.ADMIN_NO = SA.ADMINNO
			          	           AND SA.ADMINID = #adminId:VARCHAR#
									           AND SAD.ADMIN_DEPTID = hr.deptid)

		]]>
		<isNotEmpty prepend="AND" property="codeType">
			t.apply_type in ($codeType$)
	    </isNotEmpty>
	</select>

	<select id="getCountEvection" parameterClass="SimpleMap"
		resultClass="int">
	<![CDATA[
        select count(*)from 
         (select * from ess_affirm t 
			        where  t.affirm_flag = 0 
			            and ((t.apply_no in 
			            (select tt.apply_no 
			                  from ess_affirm tt 
			                 where tt.apply_no = t.apply_no 
			                   and tt.affirmor_id <> t.affirmor_id 
			                   and tt.affirm_flag = 1 
			                   and tt.affirm_level = t.affirm_level - 1) 
			          ]]>
		<isNotEmpty prepend="AND" property="maxLevel">
			t.affirm_level = #maxLevel#
		       </isNotEmpty>      
		<![CDATA[         
                       ) or t.affirm_level = '1') 
			                   and t.apply_type = 'EvectionApply'
		         ]]>

		<isNotEmpty prepend="AND" property="adminid">
			t.affirmor_id =
			#adminid#
		</isNotEmpty>
		<![CDATA[ 
		  )
		]]>
	</select>

	<select id="getCountTraining" parameterClass="SimpleMap"
		resultClass="int">
	<![CDATA[
        select count(*)from 
         (select * from ess_affirm t 
			        where  t.affirm_flag = 0 
			            and ((t.apply_no in 
			            (select tt.apply_no 
			                  from ess_affirm tt 
			                 where tt.apply_no = t.apply_no 
			                   and tt.affirmor_id <> t.affirmor_id 
			                   and tt.affirm_flag = 1 
			                   and tt.affirm_level = t.affirm_level - 1) 
			          ]]>
		<isNotEmpty prepend="AND" property="maxLevel">
			t.affirm_level = #maxLevel#
		       </isNotEmpty>      
		<![CDATA[         
                      )  or t.affirm_level = '1') 
			                   and t.apply_type = 'TrainingApply'
		         ]]>

		<isNotEmpty prepend="AND" property="adminid">
			t.affirmor_id =
			#adminid#
		</isNotEmpty>
		<![CDATA[ 
		  )
		]]>
	</select>

	<select id="getHealthOverTimeInfoList" resultClass="SimpleMap">
		<![CDATA[      
		  select  
		 CHINESENAME,ENGLISHNAME,KOREANNAME,
		 get_dept_name(hr_employee_v.DEPTID) as deptname,hr_department.dept_en_name as englishdept,hr_department.dept_kor_name as kordept,
		 post ,englishpost,korpost,
		 position,englishposition,korposition,
		 to_char(Physical_Date,'yyyy-mm-dd')Physical_Date, 
		 to_char(ADD_MONTHS(Physical_Date,12),'yyyy-mm-dd') valid_Physical_Date
		 from hr_employee_v
		 inner join HR_HEALTH on hr_employee_v.empid=HR_HEALTH.Empid 
		 inner join hr_department on hr_employee_v.deptid=hr_department.deptid
		 inner join (select empid ,max(Physical_Date) as max_Physical_Date
		 from HR_HEALTH group by empid) A1  on
		 HR_HEALTH.EMPID=A1.empid and Physical_Date=max_Physical_Date
		 where   to_date(to_char(sysdate,'yyyy-mm-dd'),'yyyy-mm-dd') between
		 ADD_MONTHS(to_date(to_char(ADD_MONTHS(Physical_Date,12),'yyyy-mm-dd'),'yyyy-mm-dd'),-1)
		 and  ADD_MONTHS(to_date(to_char(ADD_MONTHS(Physical_Date,12),'yyyy-mm-dd'),'yyyy-mm-dd'),1)
    	 ]]>
	</select>
	<select id="getExpiredProbation" resultClass="SimpleMap">
		<![CDATA[  
		   select 
		  he.chinesename, he.englishname,he.koreanname,
		  hd.deptname, hd.dept_en_name, hd.dept_kor_name,
		  to_char(he.end_probation_date,'yyyy-mm-dd') end_probation_date,
		  he.post ,he.englishpost,he.korpost,he.position ,he.englishposition,he.korposition,
		  end_probation_date - to_date(to_char(sysdate, 'yyyy-mm-dd'),  'yyyy-mm-dd') tt
		  FROM hr_employee_v he,  hr_department hd
		  WHERE he.deptid = hd.deptid 
		  and not end_probation_date is null
		  and end_probation_date - to_date(to_char(sysdate, 'yyyy-mm-dd'),  'yyyy-mm-dd') <= 30
		  and end_probation_date - to_date(to_char(sysdate, 'yyyy-mm-dd'),  'yyyy-mm-dd')  >= 0
		  order by empid
    	 ]]>
	</select>

	<select id="getExpiredContract" resultClass="SimpleMap">
		<![CDATA[ 
		     select 
		     hr_employee_v.CHINESENAME,hr_employee_v.englishname,hr_employee_v.koreanname,
		     get_dept_name(hr_employee_v.DEPTID) as deptname,hr_department.dept_en_name,hr_department.dept_kor_name,
		    HR_CONTRACT_TYPE_V.END_CONTRACT_DATE END_CONTRACT_DATE,
		    hr_employee_v.post ,hr_employee_v.englishpost,hr_employee_v.korpost,
		    hr_employee_v.position,hr_employee_v.englishposition,hr_employee_v.korposition
		    from HR_CONTRACT_TYPE_V inner join hr_employee_v on HR_CONTRACT_TYPE_V.EMPID=hr_employee_v.EMPID
			inner join hr_department on hr_employee_v.deptid=hr_department.deptid
			inner join (select empid ,max(end_contract_date) as max_end_contract_date
			from HR_CONTRACT group by empid) c2 
		    on HR_CONTRACT_TYPE_V.empid = c2.empid
			and HR_CONTRACT_TYPE_V.END_CONTRACT_DATE = to_char(max_end_contract_date,'yyyy-mm-dd')     
			where end_contract_date >= 	to_char(sysdate, 'yyyy-mm-dd')
		    and end_contract_date<= to_char(ADD_MONTHS(SYSDATE, 2), 'yyyy-mm-dd')
	                                             
  	 ]]>
	</select>
	<select id="expressAffirmInfoListNumber" parameterClass="SimpleMap"
		resultClass="int">
<![CDATA[	
	 select count(a.apply_no)  from ga_express_apply a ,hr_employee hr
	 where 	a.applyor_id=#adminId:VARCHAR# 
	 and hr.empid(+) = a.sendperson
	 and a.apply_no in( select distinct t.apply_no from ga_express_affirm t where  t.activity='1'
   )
			and	 a.ISCONFIRM =0
	]]>
	</select>

	<select id="getVoitureListList" parameterClass="SimpleMap"
		resultClass="int">
<![CDATA[	
		select count(*)
  from ga_voiture_apply t,
  hr_employee he
 where t.APPLYER_ID = #adminId:varchar#
   and t.voiture_applyid in
       (select distinct a.apply_no
          from ga_voiture_affirm a
         where a.active = 1)
         and  t.MODIFY_FLAG=0 and (t.active = 1 or t.active = 0)
         and he.person_id = t.applyer_id
        
	]]>
	</select>

	<select id="allsealAffrimInfoInt" parameterClass="SimpleMap"
		resultClass="int">
  <![CDATA[	
	select count(*)
  from GA_SEAL_APPLY seal,hr_employee e
 where seal.applyorid = e.person_id
   and seal.applyorid = #adminId:VARCHAR#
   and seal.documentno in (select distinct  a.apply_no from GA_SEAL_AFFIRM a where a.activity =1)
   and seal.ISCONFIRM=0
  ]]>
	</select>
	<select id="allvisaAffrimInfoInt" parameterClass="SimpleMap"
		resultClass="int">
  <![CDATA[	
	select count(*)
  from GA_VISA_APPLY seal,hr_employee e
 where seal.applyorid = e.person_id
   and seal.applyorid = #adminId:VARCHAR#
   and seal.documentno in (select distinct  a.apply_no from GA_VISA_AFFIRM a where a.activity =1)
   and seal.ISCONFIRM=0
  ]]>
	</select>
	<!-- get jnpj affirm count -->
	<select id="getGxxgAffirmCnt" parameterClass="SimpleMap"	resultClass="int">
		<![CDATA[
                 SELECT COUNT(*)
                   FROM EVS_CODE_AFFIRM T
                  WHERE T.AFFIRM_FLAG = 0
                    AND (T.ar_detail_no IN
                        (SELECT TT.ar_detail_no
                            FROM EVS_CODE_AFFIRM TT
                           WHERE TT.ar_detail_no = T.ar_detail_no
                             AND TT.AFFIRMOR_ID <> T.AFFIRMOR_ID
                             AND TT.AFFIRM_FLAG = 1
                             AND TT.AFFIRM_LEVEL = T.AFFIRM_LEVEL - 1) OR
                        T.AFFIRM_LEVEL = '1')
                    AND T.AFFIRMOR_ID = #adminid# 
                    AND T.ar_detail_no IN 
                    (SELECT CODE_NO FROM EVS_CODE WHERE CODE_FLAG ='JC')
		]]>
	</select>
	<select id="getGxjndjAffirmCnt" parameterClass="SimpleMap"		resultClass="int">
		<![CDATA[
                 SELECT COUNT(*)
                   FROM EVS_CODE_AFFIRM T
                  WHERE T.AFFIRM_FLAG = 0
                    AND (T.ar_detail_no IN
                        (SELECT TT.ar_detail_no
                            FROM EVS_CODE_AFFIRM TT
                           WHERE TT.ar_detail_no = T.ar_detail_no
                             AND TT.AFFIRMOR_ID <> T.AFFIRMOR_ID
                             AND TT.AFFIRM_FLAG = 1
                             AND TT.AFFIRM_LEVEL = T.AFFIRM_LEVEL - 1) OR
                        T.AFFIRM_LEVEL = '1')
                    AND T.AFFIRMOR_ID = #adminid# 
                    AND T.ar_detail_no IN 
                    (SELECT CODE_NO FROM EVS_GXJNDJ WHERE CODE_FLAG ='JC')
		]]>
	</select>
	<select id="getZyzgdjAffirmCnt" parameterClass="SimpleMap"		resultClass="int">
		<![CDATA[
                 SELECT COUNT(*)
                   FROM EVS_CODE_AFFIRM T
                  WHERE T.AFFIRM_FLAG = 0
                    AND (T.ar_detail_no IN
                        (SELECT TT.ar_detail_no
                            FROM EVS_CODE_AFFIRM TT
                           WHERE TT.ar_detail_no = T.ar_detail_no
                             AND TT.AFFIRMOR_ID <> T.AFFIRMOR_ID
                             AND TT.AFFIRM_FLAG = 1
                             AND TT.AFFIRM_LEVEL = T.AFFIRM_LEVEL - 1) OR
                        T.AFFIRM_LEVEL = '1')
                    AND T.AFFIRMOR_ID = #adminid# 
                    AND T.ar_detail_no IN 
                    (SELECT CODE_NO FROM EVS_GXJNDJ WHERE CODE_FLAG ='CT')
		]]>
	</select>
	<select id="getPjcjAffirmCnt" parameterClass="SimpleMap"		resultClass="int">
		<![CDATA[
                 SELECT COUNT(*)
                   FROM EVS_CODE_AFFIRM T
                  WHERE T.AFFIRM_FLAG = 0
                    AND (T.ar_detail_no IN
                        (SELECT TT.ar_detail_no
                            FROM EVS_CODE_AFFIRM TT
                           WHERE TT.ar_detail_no = T.ar_detail_no
                             AND TT.AFFIRMOR_ID <> T.AFFIRMOR_ID
                             AND TT.AFFIRM_FLAG = 1
                             AND TT.AFFIRM_LEVEL = T.AFFIRM_LEVEL - 1) OR
                        T.AFFIRM_LEVEL = '1')
                    AND T.AFFIRMOR_ID = #adminid# 
                    AND T.ar_detail_no IN 
                    (SELECT SETUPCODENO FROM evs_setupcode )
		]]>
	</select>
	<select id="getGjjsdjAffirmCnt" parameterClass="SimpleMap"		resultClass="int">
		<![CDATA[
                 SELECT COUNT(*)
                   FROM EVS_CODE_AFFIRM T
                  WHERE T.AFFIRM_FLAG = 0
                    AND (T.ar_detail_no IN
                        (SELECT TT.ar_detail_no
                            FROM EVS_CODE_AFFIRM TT
                           WHERE TT.ar_detail_no = T.ar_detail_no
                             AND TT.AFFIRMOR_ID <> T.AFFIRMOR_ID
                             AND TT.AFFIRM_FLAG = 1
                             AND TT.AFFIRM_LEVEL = T.AFFIRM_LEVEL - 1) OR
                        T.AFFIRM_LEVEL = '1')
                    AND T.AFFIRMOR_ID = #adminid# 
                    AND T.ar_detail_no IN 
                    (SELECT CODE_NO FROM EVS_GXJSDJ s)
		]]>
	</select>
</sqlMap>