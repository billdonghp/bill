<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN" "http://www.ibatis.com/dtd/sql-map-2.dtd">

<sqlMap namespace="kpa.postgrade">

	<select id="getPostGrade" resultClass="SimpleMap">
		<![CDATA[
				  SELECT 
				        POST_GRADE_ID,	
				        POST_GRADE_NAME,
				        POST_GRADE_VALUE,
				        HP.POST_GRADE_FIRST_NO,
				        HP.POST_GRADE_FIRST_MONEY,
				        TO_CHAR(hp.CREATE_DATE,'YYYY-MM-DD') CREATE_DATE,
		                HP.POST_GRADE_YEAR,
				       	hr.CREATED_BY,
				        HR.CHINESENAME AS CREATED_BY_NAME,
				        HR.CHINESE_PINYIN	AS CREATED_BY_PINYIN
				   FROM hr_post_grade hp,hr_employee hr
				  WHERE HP.POST_GRADE_VALUE > 0
		]]>
	<isNotEmpty prepend="AND" property="postgradeYear">
		<![CDATA[ 
				HP.POST_GRADE_YEAR = #postgradeYear:VARCHAR#
		]]>
	</isNotEmpty>
	<isEmpty prepend="AND" property="postgradeYear">
		<![CDATA[ 
				HP.POST_GRADE_YEAR = (SELECT MAX(POST_GRADE_YEAR) FROM hr_post_grade)
		]]>
	</isEmpty>
		<![CDATA[     			   
		            AND hp.created_by = hr.empid(+) 
		       order by POST_GRADE_ID
    	]]>
	</select>
	
	<select id="getPostGradeYear" resultClass="SimpleMap">
		<![CDATA[
				SELECT DISTINCT HP.POST_GRADE_YEAR
				  FROM HR_POST_GRADE HP
			  ORDER BY HP.POST_GRADE_YEAR DESC
    ]]>
	</select>

	<select id="getPostGradeById" parameterClass="SimpleMap" resultClass="SimpleMap">
		<![CDATA[  
	        select
	        	POST_GRADE_YEAR,
		        POST_GRADE_ID,	
		        POST_GRADE_NAME,
		        POST_GRADE_EN_NAME,
		        POST_GRADE_VALUE,
		        POST_GRADE_FIRST_NO,
		        POST_GRADE_FIRST_MONEY,
		        TO_CHAR(CREATE_DATE,'YYYY-MM-DD') CREATE_DATE,
		       	CREATED_BY	
			from hr_post_grade  WHERE POST_GRADE_ID= #GRADEID:VARCHAR# AND POST_GRADE_YEAR = #POST_GRADE_YEAR:VARCHAR#          
    ]]>
	</select>

	<insert id="InsertPostGrade" parameterClass="SimpleMap">
		<![CDATA[
		insert into hr_post_grade(
				 POST_GRADE_YEAR,                   
				 POST_GRADE_ID,
				 POST_GRADE_NAME, 
				 POST_GRADE_FIRST_NO,
				 POST_GRADE_FIRST_MONEY,
				 POST_GRADE_VALUE,        
				 CREATE_DATE,
				 CREATED_BY ,
				 activity
			 ) 
			 values
			 (
				 #POST_GRADE_YEAR#,
				 #GRADEID#,
				 #POSTGRADENAME#,
				 #POSTGRADEFIRSTNO:NUMERIC#,
				 #POSTGRADEFIRSTMONEY:NUMERIC#,
				 #POSTGRADEVALUE:NUMERIC#,
				 sysdate,
				 #CREATEDBY#,
				 '1'
			 )
	]]>              
	</insert>

	<update id="UpdatePostGrade" parameterClass="SimpleMap">
		<![CDATA[  
			   UPDATE hr_post_grade    
				  SET   
				  POST_GRADE_FIRST_NO=#POSTGRADEFIRSTNO:NUMERIC#,
				  POST_GRADE_FIRST_MONEY=#POSTGRADEFIRSTMONEY:NUMERIC#,
				  POST_GRADE_VALUE=#POSTGRADEVALUE:NUMERIC#,   
				  update_date=sysdate,updated_by=#UPDATEDBY# 
				  WHERE POST_GRADE_ID=#GRADEID# AND POST_GRADE_YEAR = #POST_GRADE_YEAR#
			]]>
	</update>             

	<delete id="deletePostGrade" parameterClass="string">
		<![CDATA[   
			   delete from hr_post_grade where POST_GRADE_ID=#id#    
			]]>
	</delete>
	
	
	<select id="getPostGradeTypeList" resultClass="SimpleMap">
		<![CDATA[
				 SELECT DISTINCT HP.POST_GRADE_ID,HP.POST_GRADE_NAME FROM HR_POST_GRADE HP ORDER BY HP.POST_GRADE_ID
		]]>
	</select>
	
	<select id="validateInsertPostGrade" parameterClass="SimpleMap" resultClass="int">
		<![CDATA[
				 SELECT COUNT(*) FROM HR_POST_GRADE HP WHERE HP.POST_GRADE_YEAR = #POST_GRADE_YEAR# AND HP.POST_GRADE_ID = #GRADEID#
		]]>
	</select>
	
</sqlMap>